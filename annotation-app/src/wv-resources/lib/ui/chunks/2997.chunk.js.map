{"version":3,"file":"chunks/2997.chunk.js","mappings":"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","sources":["webpack://webviewer-ui/./src/components/NotesPanel/VirtualizedList/VirtualizedList.js","webpack://webviewer-ui/./src/components/NotesPanel/VirtualizedList/index.js","webpack://webviewer-ui/./src/components/NotesPanel/NormalList/NormalList.js","webpack://webviewer-ui/./src/components/NotesPanel/NormalList/index.js","webpack://webviewer-ui/./src/components/Note/ReplyArea/ReplyAreaMultiSelect.js","webpack://webviewer-ui/./src/components/NotesPanel/MultiStylePopup.js","webpack://webviewer-ui/./src/components/NotesPanel/MultiSelectControls.js","webpack://webviewer-ui/./src/components/NotesPanelHeader/NotesPanelHeader.js","webpack://webviewer-ui/./src/components/NotesPanelHeader/index.js","webpack://webviewer-ui/./src/components/NotesPanel/NotesPanel.js","webpack://webviewer-ui/./src/components/NotesPanel/NotesPanelContainer.js","webpack://webviewer-ui/./src/components/NotesPanel/index.js","webpack://webviewer-ui/./src/components/Note/ReplyArea/ReplyAreaMultiSelect.scss","webpack://webviewer-ui/./src/components/NotesPanelHeader/NotesPanelHeader.scss","webpack://webviewer-ui/./src/components/NotesPanel/MultiSelectControls.scss","webpack://webviewer-ui/./src/components/NotesPanel/MultiStylePopup.scss","webpack://webviewer-ui/./src/components/NotesPanel/NotesPanel.scss","webpack://webviewer-ui/./src/components/Note/ReplyArea/ReplyAreaMultiSelect.scss?06f4","webpack://webviewer-ui/./src/components/NotesPanelHeader/NotesPanelHeader.scss?2433","webpack://webviewer-ui/./src/components/NotesPanel/MultiSelectControls.scss?ae2d","webpack://webviewer-ui/./src/components/NotesPanel/MultiStylePopup.scss?bef0","webpack://webviewer-ui/./src/components/NotesPanel/NotesPanel.scss?d97d"],"sourcesContent":["import React, { useState, useEffect, useRef, useImperativeHandle } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Measure from 'react-measure';\r\nimport { CellMeasurer, CellMeasurerCache, List } from 'react-virtualized';\r\n\r\nconst propTypes = {\r\n  notes: PropTypes.array.isRequired,\r\n  children: PropTypes.func.isRequired,\r\n  onScroll: PropTypes.func.isRequired,\r\n  initialScrollTop: PropTypes.number.isRequired,\r\n  selectedIndex: PropTypes.number,\r\n  sortStrategy: PropTypes.string,\r\n};\r\n\r\nconst cache = new CellMeasurerCache({ defaultHeight: 50, fixedWidth: true });\r\n\r\nconst VirtualizedList = React.forwardRef(\r\n  ({ notes, children, onScroll, initialScrollTop, selectedIndex, sortStrategy }, forwardedRef) => {\r\n    const listRef = useRef();\r\n    const [offset, setOffset] = useState(0);\r\n    const [dimension, setDimension] = useState({ width: 0, height: 0 });\r\n    let prevWindowHeight = window.innerHeight;\r\n\r\n    useImperativeHandle(forwardedRef, () => ({\r\n      scrollToPosition: (scrollTop) => {\r\n        listRef.current.scrollToPosition(scrollTop);\r\n      },\r\n      scrollToRow: (index) => {\r\n        listRef.current.scrollToRow(index);\r\n      },\r\n    }));\r\n\r\n    useEffect(() => {\r\n      listRef.current.scrollToPosition(initialScrollTop);\r\n    }, [initialScrollTop]);\r\n\r\n    useEffect(() => {\r\n      cache.clearAll();\r\n      listRef?.current?.measureAllRows();\r\n\r\n      if (selectedIndex !== -1) {\r\n        listRef.current?.scrollToRow(selectedIndex);\r\n      }\r\n    }, [selectedIndex]);\r\n\r\n    useEffect(() => {\r\n      cache.clearAll();\r\n      listRef?.current?.measureAllRows();\r\n      listRef?.current?.forceUpdateGrid();\r\n    }, [notes.length, sortStrategy]);\r\n\r\n    useEffect(() => {\r\n      const windowResizeHandler = () => {\r\n        const diff = window.innerHeight - prevWindowHeight;\r\n        if (diff) {\r\n          // List height never resizes down after exiting fullscreen\r\n          if (window.innerHeight < prevWindowHeight) {\r\n            setOffset(diff);\r\n          }\r\n          prevWindowHeight = window.innerHeight;\r\n        }\r\n      };\r\n      window.addEventListener('resize', windowResizeHandler);\r\n\r\n      return () => {\r\n        window.removeEventListener('resize', windowResizeHandler);\r\n      };\r\n    });\r\n\r\n    const _resize = (index) => {\r\n      cache.clear(index);\r\n      listRef.current?.recomputeRowHeights(index);\r\n    };\r\n\r\n    const handleScroll = ({ scrollTop }) => {\r\n      onScroll(scrollTop);\r\n    };\r\n\r\n    /* eslint-disable react/prop-types */\r\n    const rowRenderer = ({ index, key, parent, style }) => {\r\n      const currNote = notes[index];\r\n\r\n      // Padding added to the right since virtualized list lets it get cut off on the right\r\n      return (\r\n        <CellMeasurer\r\n          key={`${key}${currNote.Id}`}\r\n          cache={cache}\r\n          columnIndex={0}\r\n          parent={parent}\r\n          rowIndex={index}\r\n        >\r\n          {({ measure }) => (\r\n            <div style={{ ...style, paddingRight: '12px' }}>\r\n              {children(notes, index, () => {\r\n                _resize(index);\r\n                measure();\r\n              })}\r\n            </div>)}\r\n        </CellMeasurer>\r\n      );\r\n    };\r\n\r\n    return (\r\n      <Measure bounds offset onResize={({ bounds }) => {\r\n        setDimension({\r\n          ...bounds,\r\n          // Override height and compensate for extra size\r\n          height: bounds.height + offset * 2,\r\n        });\r\n        setOffset(0);\r\n      }}\r\n      >\r\n        {({ measureRef }) => (\r\n          <div ref={measureRef} className=\"virtualized-notes-container\">\r\n            <List\r\n              deferredMeasurementCache={cache}\r\n              style={{ outline: 'none' }}\r\n              height={dimension.height - offset}\r\n              width={dimension.width}\r\n              overscanRowCount={10}\r\n              ref={listRef}\r\n              rowCount={notes.length}\r\n              rowHeight={cache.rowHeight}\r\n              rowRenderer={rowRenderer}\r\n              onScroll={handleScroll}\r\n              aria-label='presentation'\r\n              role='presentation'\r\n            />\r\n          </div>\r\n        )}\r\n      </Measure>\r\n    );\r\n  },\r\n);\r\n\r\nVirtualizedList.displayName = 'VirtualizedList';\r\nVirtualizedList.propTypes = propTypes;\r\n\r\nexport default VirtualizedList;\r\n","import VirtualizedList from './VirtualizedList';\r\n\r\nexport default VirtualizedList;","import React, { useEffect, useRef, useImperativeHandle } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nconst propTypes = {\r\n  notes: PropTypes.array.isRequired,\r\n  children: PropTypes.func.isRequired,\r\n  onScroll: PropTypes.func.isRequired,\r\n  initialScrollTop: PropTypes.number.isRequired,\r\n};\r\n\r\nconst NormalList = React.forwardRef(\r\n  ({ notes, children, onScroll, initialScrollTop }, forwardedRef) => {\r\n    const listRef = useRef();\r\n\r\n    useImperativeHandle(forwardedRef, () => ({\r\n      scrollToPosition: (scrollTop) => {\r\n        listRef.current.scrollTop = scrollTop;\r\n      },\r\n      scrollToRow: (index) => {\r\n        const parent = listRef.current;\r\n        const child = parent.children[index];\r\n        if (!child) {\r\n          return;\r\n        }\r\n\r\n        const parentRect = parent.getBoundingClientRect();\r\n        const childRect = child.getBoundingClientRect();\r\n\r\n        const isViewable =\r\n          childRect.top >= parentRect.top &&\r\n          childRect.top <= parentRect.top + parent.clientHeight;\r\n        if (!isViewable) {\r\n          parent.scrollTop = childRect.top + parent.scrollTop - parentRect.top;\r\n        }\r\n      },\r\n    }));\r\n\r\n    useEffect(() => {\r\n      listRef.current.scrollTop = initialScrollTop;\r\n    }, [initialScrollTop]);\r\n\r\n    const handleScroll = (e) => {\r\n      onScroll(e.target.scrollTop);\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={listRef}\r\n        className=\"normal-notes-container\"\r\n        onScroll={handleScroll}\r\n        role=\"list\"\r\n      >\r\n        {notes.map((currNote, index) => (\r\n          <React.Fragment key={`${index}_${currNote.Id}`}>\r\n            {children(notes, index)}\r\n          </React.Fragment>\r\n        ))}\r\n      </div>\r\n    );\r\n  },\r\n);\r\n\r\nNormalList.displayName = 'NormalList';\r\nNormalList.propTypes = propTypes;\r\n\r\nexport default NormalList;\r\n","import NormalList from './NormalList';\r\n\r\nexport default NormalList;","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useSelector, shallowEqual } from 'react-redux';\r\nimport { useTranslation } from 'react-i18next';\r\nimport NoteTextarea from 'components/NoteTextarea';\r\nimport classNames from 'classnames';\r\nimport core from 'core';\r\nimport mentionsManager from 'helpers/MentionsManager';\r\nimport setAnnotationRichTextStyle from 'helpers/setAnnotationRichTextStyle';\r\nimport selectors from 'selectors';\r\nimport Button from 'src/components/Button';\r\nimport Icon from 'components/Icon';\r\n\r\nimport './ReplyAreaMultiSelect.scss';\r\n\r\n// a component that contains the reply textarea, the reply button and the cancel button\r\nconst ReplyArea = ({ annotations, onSubmit, onClose }) => {\r\n  const [\r\n    isMentionEnabled,\r\n    activeDocumentViewerKey,\r\n  ] = useSelector(\r\n    (state) => [\r\n      selectors.getIsMentionEnabled(state),\r\n      selectors.getActiveDocumentViewerKey(state),\r\n    ],\r\n    shallowEqual\r\n  );\r\n\r\n  const [pendingReply, setPendingReply] = useState('');\r\n  const [t] = useTranslation();\r\n  const textareaRef = useRef();\r\n\r\n  useEffect(() => {\r\n    textareaRef.current.focus();\r\n  }, []);\r\n\r\n  const postReply = (e) => {\r\n    // prevent the textarea from blurring out\r\n    e.preventDefault();\r\n\r\n    const editor = textareaRef.current.getEditor();\r\n    const replyText = mentionsManager.getFormattedTextFromDeltas(editor.getContents());\r\n\r\n    if (!replyText.trim()) {\r\n      return;\r\n    }\r\n    annotations.forEach((annotation) => {\r\n      if (isMentionEnabled) {\r\n        const replyAnnotation = mentionsManager.createMentionReply(annotation, replyText);\r\n        core.addAnnotations([replyAnnotation], activeDocumentViewerKey);\r\n        setAnnotationRichTextStyle(editor, replyAnnotation);\r\n      } else {\r\n        // TODO: This is bugged and does not work. createAnnotationReply\r\n        // does not return an annotation\r\n        const replyAnnotation = core.createAnnotationReply(annotation, replyText, activeDocumentViewerKey);\r\n        setAnnotationRichTextStyle(editor, replyAnnotation);\r\n      }\r\n    });\r\n\r\n    onSubmit();\r\n  };\r\n\r\n  const replyAreaClass = classNames({\r\n    'reply-area': true,\r\n  });\r\n\r\n  const handleNoteTextareaChange = (value) => {\r\n    setPendingReply(value);\r\n  };\r\n\r\n  return (\r\n    <div className='reply-area-multi-container'>\r\n      <div\r\n        className=\"reply-area-multi-header\"\r\n      >\r\n        <div className=\"title\">\r\n          {t('action.multiReplyAnnotations', { count: annotations.length })}\r\n        </div>\r\n        <div\r\n          className=\"close-icon-container\"\r\n          onClick={onClose}\r\n        >\r\n          <Icon\r\n            glyph=\"ic_close_black_24px\"\r\n            className=\"close-icon\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <form onSubmit={postReply} >\r\n        <div\r\n          className={replyAreaClass}\r\n          // stop bubbling up otherwise the note will be closed\r\n          // due to annotation deselection\r\n          onMouseDown={(e) => e.stopPropagation()}\r\n        >\r\n          <NoteTextarea\r\n            ref={(el) => {\r\n              textareaRef.current = el;\r\n            }}\r\n            value={pendingReply}\r\n            onChange={(value) => handleNoteTextareaChange(value)}\r\n            isReply\r\n          />\r\n        </div>\r\n        <div className='reply-button-container'>\r\n          <Button\r\n            img=\"icon-post-reply\"\r\n            className={'reply-button'}\r\n            isSubmitType={true}\r\n          />\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReplyArea;\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport getOverlayPositionBasedOn from 'helpers/getOverlayPositionBasedOn';\r\nimport PopupPortal from 'components/PopupPortal';\r\nimport AnnotationStylePopup from 'components/AnnotationStylePopup';\r\n\r\nimport useOnClickOutside from 'hooks/useOnClickOutside';\r\nimport getAnnotationStyles from 'helpers/getAnnotationStyles';\r\nimport { getOpenedWarningModal, getOpenedColorPicker, getDatePicker } from 'helpers/getElements';\r\nimport actions from 'actions';\r\nimport {\r\n  AnnotationStylePopupTabs,\r\n  updateAnnotationStylePopupTabs,\r\n  copyMapWithDataProperties,\r\n  getDataWithKey,\r\n} from 'constants/map';\r\n\r\n\r\nimport './MultiStylePopup.scss';\r\n\r\nconst MultiStylePopup = ({\r\n  annotations,\r\n  triggerElementName,\r\n  onClose = () => { },\r\n}) => {\r\n  const dispatch = useDispatch();\r\n  const popupRef = useRef();\r\n  const [styleTabs, setStyleTabs] = useState([]);\r\n  const [position, setPosition] = useState({ left: 'auto', right: 'auto', top: 'auto' });\r\n  const colorMapKey = 'MultiStyle';\r\n\r\n  useOnClickOutside(popupRef, (e) => {\r\n    const triggerElement = document.querySelector(`[data-element=${triggerElementName}]`);\r\n    const clickedTrigger = triggerElement.contains(e.target);\r\n    const warningModal = getOpenedWarningModal();\r\n    const colorPicker = getOpenedColorPicker();\r\n    const datePicker = getDatePicker();\r\n\r\n    if (!clickedTrigger && !warningModal && !colorPicker && !datePicker) {\r\n      // we only want to close the popup if we clicked outside and not on the trigger\r\n      onClose();\r\n    }\r\n  });\r\n\r\n  let style = {};\r\n  annotations.forEach((annotation) => {\r\n    style = { ...style, ...getAnnotationStyles(annotation) };\r\n  });\r\n  const freeTextAnnotation = annotations.find((annotation) => {\r\n    return (\r\n      annotation instanceof window.Core.Annotations.FreeTextAnnotation &&\r\n      (annotation.getIntent() === window.Core.Annotations.FreeTextAnnotation.Intent.FreeText ||\r\n      annotation.getIntent() === window.Core.Annotations.FreeTextAnnotation.Intent.FreeTextCallout)\r\n    );\r\n  });\r\n  let properties = {};\r\n  if (freeTextAnnotation) {\r\n    const richTextStyles = freeTextAnnotation.getRichTextStyle();\r\n    properties = {\r\n      Font: freeTextAnnotation.Font,\r\n      FontSize: freeTextAnnotation.FontSize,\r\n      TextAlign: freeTextAnnotation.TextAlign,\r\n      TextVerticalAlign: freeTextAnnotation.TextVerticalAlign,\r\n      bold: richTextStyles?.[0]?.['font-weight'] === 'bold' ?? false,\r\n      italic: richTextStyles?.[0]?.['font-style'] === 'italic' ?? false,\r\n      underline: richTextStyles?.[0]?.['text-decoration']?.includes('underline') || richTextStyles?.[0]?.['text-decoration']?.includes('word'),\r\n      strikeout: richTextStyles?.[0]?.['text-decoration']?.includes('line-through') ?? false,\r\n    };\r\n  }\r\n\r\n  // Update available palettesfor MultiStyle annotation type in map\r\n  useEffect(() => {\r\n    const availablePalettes = [];\r\n    style['TextColor'] && availablePalettes.push(AnnotationStylePopupTabs.TEXT_COLOR);\r\n    style['StrokeColor'] && availablePalettes.push(AnnotationStylePopupTabs.STROKE_COLOR);\r\n    style['FillColor'] && availablePalettes.push(AnnotationStylePopupTabs.FILL_COLOR);\r\n\r\n    const didUpdate =\r\n      updateAnnotationStylePopupTabs(colorMapKey, availablePalettes, availablePalettes[0]);\r\n    if (didUpdate) {\r\n      const newColorMap = copyMapWithDataProperties('currentStyleTab', 'iconColor');\r\n      dispatch(actions.setColorMap(newColorMap));\r\n      const { styleTabs: _styleTabs } = getDataWithKey(colorMapKey);\r\n      setStyleTabs(_styleTabs);\r\n    }\r\n  }, [annotations]);\r\n\r\n  const updatePosition = () => {\r\n    const position = getOverlayPositionBasedOn(triggerElementName, popupRef);\r\n    setPosition(position);\r\n  };\r\n\r\n  // Have to wait until palettes are available before showing popup\r\n  if (styleTabs.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <PopupPortal\r\n      id=\"multi-style-popup-portal\"\r\n      position={position}\r\n    >\r\n      <div\r\n        className='multi-style-container'\r\n        ref={popupRef}\r\n      >\r\n        <AnnotationStylePopup\r\n          annotations={annotations}\r\n          style={style}\r\n          isOpen\r\n          onResize={updatePosition}\r\n          isFreeText={!!freeTextAnnotation}\r\n          colorMapKey={colorMapKey}\r\n          properties={properties}\r\n          isRedaction={false}\r\n          isMeasure={false}\r\n          showLineStyleOptions={false}\r\n          hideSnapModeCheckbox={false}\r\n        />\r\n      </div>\r\n    </PopupPortal >\r\n  );\r\n};\r\n\r\nexport default MultiStylePopup;","import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector, shallowEqual } from 'react-redux';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Icon from 'components/Icon';\r\nimport Button from 'components/Button';\r\nimport ReplyAreaMultiSelect from 'components/Note/ReplyArea/ReplyAreaMultiSelect';\r\nimport MultiStylePopup from 'components/NotesPanel/MultiStylePopup';\r\nimport NoteStatePopup from 'components/NoteState/NoteStatePopup';\r\nimport NoteContext from 'components/Note/Context';\r\n\r\nimport { createStateAnnotation } from 'helpers/NoteStateUtils';\r\nimport DataElements from 'constants/dataElement';\r\nimport PropTypes from 'prop-types';\r\nimport actions from 'actions';\r\nimport classNames from 'classnames';\r\nimport core from 'core';\r\nimport selectors from 'selectors';\r\n\r\nimport './MultiSelectControls.scss';\r\n\r\nconst propTypes = {\r\n  showMultiReply: PropTypes.bool.isRequired,\r\n  setShowMultiReply: PropTypes.func.isRequired,\r\n  showMultiState: PropTypes.bool.isRequired,\r\n  setShowMultiState: PropTypes.func.isRequired,\r\n  showMultiStyle: PropTypes.bool.isRequired,\r\n  setShowMultiStyle: PropTypes.func.isRequired,\r\n  setMultiSelectMode: PropTypes.func.isRequired,\r\n  isMultiSelectedMap: PropTypes.object.isRequired,\r\n  setIsMultiSelectedMap: PropTypes.func.isRequired,\r\n  multiSelectedAnnotations: PropTypes.array.isRequired,\r\n};\r\n\r\nconst getParentAnnotations = (annotations, documentViewerKey = 1) => {\r\n  const annotSet = new Set();\r\n  annotations.forEach((annotation) => {\r\n    if (annotation.isGrouped()) {\r\n      const parentAnnotation = core.getAnnotationById(annotation['InReplyTo'], documentViewerKey);\r\n      if (parentAnnotation) {\r\n        annotSet.add(parentAnnotation);\r\n      }\r\n    } else {\r\n      annotSet.add(annotation);\r\n    }\r\n  });\r\n  return Array.from(annotSet);\r\n};\r\n\r\nconst MultiSelectControls = ({\r\n  showMultiReply,\r\n  setShowMultiReply,\r\n  showMultiState,\r\n  setShowMultiState,\r\n  showMultiStyle,\r\n  setShowMultiStyle,\r\n  setMultiSelectMode,\r\n  isMultiSelectedMap,\r\n  setIsMultiSelectedMap,\r\n  multiSelectedAnnotations,\r\n}) => {\r\n  const [\r\n    modifiableMultiSelectAnnotations,\r\n    setModfiableMultiSelectAnnotations,\r\n  ] = useState([]);\r\n  const dispatch = useDispatch();\r\n  const [t] = useTranslation();\r\n  const [activeDocumentViewerKey, isDocumentReadOnly] = useSelector(\r\n    (state) => [\r\n      selectors.getActiveDocumentViewerKey(state),\r\n      selectors.isDocumentReadOnly(state),\r\n    ],\r\n    shallowEqual,\r\n  );\r\n\r\n  useEffect(() => {\r\n    const onAnnotationChanged = (annotations, action) => {\r\n      if (action === 'delete') {\r\n        const _isMultiSelectedMap = { ...isMultiSelectedMap };\r\n        annotations.forEach((annot) => {\r\n          delete _isMultiSelectedMap[annot.Id];\r\n        });\r\n        setIsMultiSelectedMap(_isMultiSelectedMap);\r\n      } else if (action === 'modify') {\r\n        const _isMultiSelectedMap = { ...isMultiSelectedMap };\r\n        // update isMultiSelectedMap by looking at modified annots and\r\n        // their grouped annots\r\n        annotations.forEach((annot) => {\r\n          const groupedAnnots = core.getGroupAnnotations(annot, activeDocumentViewerKey);\r\n          const someAnnotInGroupIsSelected =\r\n            groupedAnnots.some((groupedAnnot) => isMultiSelectedMap[groupedAnnot.Id]);\r\n          if (someAnnotInGroupIsSelected) {\r\n            // select all annots in this group\r\n            groupedAnnots.forEach((groupAnnot) => {\r\n              _isMultiSelectedMap[groupAnnot.Id] = groupAnnot;\r\n            });\r\n          }\r\n        });\r\n\r\n        const originalKeys = Object.keys(isMultiSelectedMap);\r\n        const updatedKeys = Object.keys(isMultiSelectedMap);\r\n        const difference = originalKeys.filter((key) => !updatedKeys.includes(key));\r\n        if (difference.length > 0) {\r\n          // Only update if we have a difference to not cause re-renders and\r\n          // actions to not be dispatched if unneeded.\r\n          setIsMultiSelectedMap(_isMultiSelectedMap);\r\n        }\r\n      }\r\n    };\r\n\r\n    core.addEventListener('annotationChanged', onAnnotationChanged, undefined, activeDocumentViewerKey);\r\n    return () => {\r\n      core.removeEventListener('annotationChanged', onAnnotationChanged, activeDocumentViewerKey);\r\n    };\r\n  }, [isMultiSelectedMap, activeDocumentViewerKey]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      setShowMultiReply(false);\r\n      setIsMultiSelectedMap({});\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const _modifiableMultiSelectAnnotations = multiSelectedAnnotations.filter((multiSelectedAnnot) => {\r\n      return core.canModify(multiSelectedAnnot, activeDocumentViewerKey);\r\n    });\r\n    setModfiableMultiSelectAnnotations(_modifiableMultiSelectAnnotations);\r\n  }, [multiSelectedAnnotations]);\r\n\r\n  const numberOfGroups = core.getNumberOfGroups(modifiableMultiSelectAnnotations, activeDocumentViewerKey);\r\n  const canGroup = numberOfGroups > 1;\r\n  const canUngroup = !canGroup && (modifiableMultiSelectAnnotations.length > 2 ||\r\n    (modifiableMultiSelectAnnotations.length > 0 && core.getGroupAnnotations(modifiableMultiSelectAnnotations[0], activeDocumentViewerKey).length > 1));\r\n\r\n  const handleStateChange = (newValue) => {\r\n    getParentAnnotations(multiSelectedAnnotations, activeDocumentViewerKey).forEach((annot) => {\r\n      const stateAnnotation = createStateAnnotation(annot, newValue, activeDocumentViewerKey);\r\n      annot.addReply(stateAnnotation);\r\n      const annotationManager = core.getAnnotationManager(activeDocumentViewerKey);\r\n      annotationManager.addAnnotation(stateAnnotation);\r\n      annotationManager.trigger('addReply', [stateAnnotation, annot, annotationManager.getRootAnnotation(annot)]);\r\n    });\r\n    setShowMultiState(false);\r\n  };\r\n\r\n  if (showMultiReply) {\r\n    return (\r\n      <NoteContext.Provider value={{\r\n        resize: () => {},\r\n      }}>\r\n        <ReplyAreaMultiSelect\r\n          annotations={getParentAnnotations(multiSelectedAnnotations, activeDocumentViewerKey)}\r\n          onSubmit={() => setShowMultiReply(false)}\r\n          onClose={() => setShowMultiReply(false)}\r\n        />\r\n      </NoteContext.Provider>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"multi-select-footer\">\r\n      <div className=\"buttons-container\">\r\n        <Button\r\n          dataElement={DataElements.NOTE_MULTI_REPLY_BUTTON}\r\n          disabled={isDocumentReadOnly || multiSelectedAnnotations.length === 0}\r\n          img=\"icon-header-chat-line\"\r\n          onClick={() => {\r\n            setShowMultiReply(true);\r\n          }}\r\n          title=\"action.comment\"\r\n        />\r\n        <Button\r\n          dataElement={DataElements.NOTE_MULTI_STATE_BUTTON}\r\n          className={classNames({\r\n            active: showMultiState,\r\n          })}\r\n          disabled={isDocumentReadOnly || modifiableMultiSelectAnnotations.length === 0}\r\n          img=\"icon-annotation-status-none\"\r\n          onClick={() => {\r\n            setShowMultiState(!showMultiState);\r\n          }}\r\n          title=\"option.notesOrder.status\"\r\n        />\r\n        {showMultiState &&\r\n          <NoteStatePopup\r\n            style={{\r\n              position: 'relative',\r\n              bottom: '52px',\r\n            }}\r\n            triggerElementName=\"multiStateButton\"\r\n            handleStateChange={handleStateChange}\r\n            onClose={() => {\r\n              setShowMultiState(false);\r\n            }}\r\n          />}\r\n        <Button\r\n          dataElement={DataElements.NOTE_MULTI_STYLE_BUTTON}\r\n          img=\"icon-menu-style-line\"\r\n          disabled={isDocumentReadOnly || modifiableMultiSelectAnnotations.length === 0}\r\n          onClick={() => {\r\n            setShowMultiStyle(!showMultiStyle);\r\n          }}\r\n          title=\"action.style\"\r\n        />\r\n        {showMultiStyle &&\r\n          <MultiStylePopup\r\n            annotations={modifiableMultiSelectAnnotations}\r\n            triggerElementName=\"multiStyleButton\"\r\n            onClose={() => {\r\n              setShowMultiStyle(false);\r\n            }}\r\n          />}\r\n        {!canUngroup &&\r\n          <Button\r\n            dataElement={DataElements.NOTE_MULTI_GROUP_BUTTON}\r\n            disabled={isDocumentReadOnly || !canGroup}\r\n            img=\"group-annotations-icon\"\r\n            onClick={() => {\r\n              core.groupAnnotations(multiSelectedAnnotations[0], multiSelectedAnnotations, activeDocumentViewerKey);\r\n            }}\r\n            title=\"action.group\"\r\n          />}\r\n        {canUngroup &&\r\n          <Button\r\n            dataElement={DataElements.NOTE_MULTI_UNGROUP_BUTTON}\r\n            img=\"ungroup-annotations-icon\"\r\n            onClick={() => {\r\n              core.ungroupAnnotations(multiSelectedAnnotations, activeDocumentViewerKey);\r\n            }}\r\n            title=\"action.ungroup\"\r\n          />}\r\n        <Button\r\n          dataElement={DataElements.NOTE_MULTI_DELETE_BUTTON}\r\n          disabled={isDocumentReadOnly || modifiableMultiSelectAnnotations.length === 0}\r\n          img=\"icon-delete-line\"\r\n          onClick={() => {\r\n            const title = t('warning.multiDeleteAnnotation.title');\r\n            const message = t('warning.multiDeleteAnnotation.message');\r\n            const confirmBtnText = t('action.delete');\r\n\r\n            const warning = {\r\n              title,\r\n              message,\r\n              confirmBtnText,\r\n              onConfirm: () => {\r\n                core.deleteAnnotations(modifiableMultiSelectAnnotations, undefined, activeDocumentViewerKey);\r\n              },\r\n            };\r\n            dispatch(actions.showWarningMessage(warning));\r\n          }}\r\n          title=\"action.delete\"\r\n        />\r\n      </div>\r\n      <div\r\n        className=\"close-container\"\r\n      >\r\n        <div\r\n          className=\"close-icon-container\"\r\n          onClick={() => {\r\n            setMultiSelectMode(false);\r\n          }}\r\n        >\r\n          <Icon\r\n            glyph=\"ic_close_black_24px\"\r\n            className=\"close-icon\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nMultiSelectControls.propTypes = propTypes;\r\n\r\nexport default MultiSelectControls;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\r\nimport { useTranslation } from 'react-i18next';\r\nimport debounce from 'lodash/debounce';\r\nimport selectors from 'selectors';\r\nimport actions from 'actions';\r\nimport classNames from 'classnames';\r\nimport core from 'core';\r\n\r\nimport Dropdown from 'components/Dropdown';\r\nimport Button from 'components/Button';\r\nimport DataElementWrapper from 'components/DataElementWrapper';\r\nimport CustomElement from 'components/CustomElement';\r\n\r\nimport Events from 'constants/events';\r\nimport { getSortStrategies } from 'constants/sortStrategies';\r\nimport DataElements from 'constants/dataElement';\r\n\r\nimport './NotesPanelHeader.scss';\r\n\r\nconst SORT_CONTAINER_ELEMENT = 'sortContainer';\r\n\r\nfunction NotesPanelHeader({\r\n  notes,\r\n  disableFilterAnnotation,\r\n  setSearchInputHandler,\r\n  isMultiSelectMode,\r\n  toggleMultiSelectMode,\r\n  isMultiSelectEnabled,\r\n}) {\r\n  const [\r\n    sortStrategy,\r\n    isSortContainerDisabled,\r\n    customHeaderOptions,\r\n    annotationFilters,\r\n    featureFlags,\r\n    isOfficeEditorMode,\r\n  ] = useSelector(\r\n    (state) => [\r\n      selectors.getSortStrategy(state),\r\n      selectors.isElementDisabled(state, SORT_CONTAINER_ELEMENT),\r\n      selectors.getNotesPanelCustomHeaderOptions(state),\r\n      selectors.getAnnotationFilters(state),\r\n      selectors.getFeatureFlags(state),\r\n      selectors.getIsOfficeEditorMode(state),\r\n    ],\r\n    shallowEqual\r\n  );\r\n\r\n  const [t] = useTranslation();\r\n  const dispatch = useDispatch();\r\n  const [filterEnabled, setFilterEnabled] = useState(false);\r\n  const customizableUI = featureFlags.customizableUI;\r\n\r\n  useEffect(() => {\r\n    // check if Redux filter state is enabled on mount and set filterEnabled to true\r\n    const { authorFilter, colorFilter, statusFilter, typeFilter } = annotationFilters;\r\n    if (authorFilter?.length > 0 || colorFilter?.length > 0 || statusFilter?.length > 0 || typeFilter?.length > 0) {\r\n      setFilterEnabled(true);\r\n    }\r\n\r\n    const toggleFilterStyle = (e) => {\r\n      const { types, authors, colors, statuses } = e.detail;\r\n      if (types.length > 0 || authors.length > 0 || colors.length > 0 || statuses.length > 0) {\r\n        setFilterEnabled(true);\r\n      } else {\r\n        setFilterEnabled(false);\r\n      }\r\n    };\r\n\r\n    window.addEventListener(Events.ANNOTATION_FILTER_CHANGED, toggleFilterStyle);\r\n    return () => {\r\n      window.removeEventListener(Events.ANNOTATION_FILTER_CHANGED, toggleFilterStyle);\r\n    };\r\n  }, []);\r\n\r\n  const handleInputChange = (e) => {\r\n    _handleInputChange(e.target.value);\r\n  };\r\n\r\n  const _handleInputChange = debounce((value) => {\r\n    // this function is used to solve the issue with using synthetic event asynchronously.\r\n    // https://reactjs.org/docs/events.html#event-pooling\r\n    core.deselectAllAnnotations();\r\n    setSearchInputHandler(value);\r\n  }, 500);\r\n\r\n  const sortContainer = (\r\n    <div className=\"sort-container\" data-element={SORT_CONTAINER_ELEMENT}>\r\n      <div className=\"label\">{`${t('message.sortBy')}:`}</div>\r\n      <Dropdown\r\n        dataElement=\"notesOrderDropdown\"\r\n        disabled={notes.length === 0}\r\n        items={Object.keys(getSortStrategies())}\r\n        translationPrefix=\"option.notesOrder\"\r\n        currentSelectionKey={sortStrategy}\r\n        onClickItem={(strategy) => {\r\n          dispatch(actions.setNotesPanelSortStrategy(strategy));\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  const originalHeaderElement = (\r\n    <DataElementWrapper\r\n      className={\r\n        classNames({\r\n          'header': true,\r\n          'custom-header': customizableUI,\r\n        })}\r\n      dataElement=\"notesPanelHeader\"\r\n    >\r\n      <DataElementWrapper\r\n        className=\"input-container\"\r\n        dataElement={DataElements.NotesPanel.DefaultHeader.INPUT_CONTAINER}\r\n      >\r\n        <input\r\n          type=\"text\"\r\n          placeholder={t('message.searchCommentsPlaceholder')}\r\n          aria-label={t('message.searchCommentsPlaceholder')}\r\n          onChange={handleInputChange}\r\n          id=\"NotesPanel__input\"\r\n        />\r\n      </DataElementWrapper>\r\n\r\n      <DataElementWrapper\r\n        className=\"comments-counter\"\r\n        dataElement={DataElements.NotesPanel.DefaultHeader.COMMENTS_COUNTER}\r\n      >\r\n        <span className='main-comment'>{isOfficeEditorMode ? t('officeEditor.reviewing') : t('component.notesPanel')}</span> {`(${notes.length})`}\r\n      </DataElementWrapper>\r\n\r\n      <DataElementWrapper\r\n        className=\"sort-row\"\r\n        dataElement={DataElements.NotesPanel.DefaultHeader.SORT_ROW}\r\n      >\r\n        {(isSortContainerDisabled) ? <div className=\"sort-container\"></div> : sortContainer}\r\n        <div\r\n          className=\"buttons-container\"\r\n        >\r\n          {isMultiSelectEnabled && (\r\n            <Button\r\n              dataElement={DataElements.NOTE_MULTI_SELECT_MODE_BUTTON}\r\n              className={classNames({\r\n                active: isMultiSelectMode,\r\n              })}\r\n              disabled={notes.length === 0}\r\n              img=\"icon-annotation-select-multiple\"\r\n              onClick={() => {\r\n                core.deselectAllAnnotations();\r\n                toggleMultiSelectMode();\r\n              }}\r\n              title={t('component.multiSelectButton')}\r\n            />\r\n          )}\r\n          <Button\r\n            dataElement={DataElements.NotesPanel.DefaultHeader.FILTER_ANNOTATION_BUTTON}\r\n            className={classNames({\r\n              active: filterEnabled\r\n            })}\r\n            disabled={disableFilterAnnotation}\r\n            img=\"icon-comments-filter\"\r\n            onClick={() => dispatch(actions.openElement('filterModal'))}\r\n            title={t('component.filter')}\r\n          />\r\n        </div>\r\n      </DataElementWrapper>\r\n    </DataElementWrapper>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {customHeaderOptions &&\r\n        <CustomElement\r\n          render={customHeaderOptions.render}\r\n          renderArguments={[notes]}\r\n        />\r\n      }\r\n\r\n      {(!customHeaderOptions || !customHeaderOptions.overwriteDefaultHeader) &&\r\n        originalHeaderElement\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default NotesPanelHeader;\r\n","import NotesPanelHeader from './NotesPanelHeader';\r\n\r\nexport default NotesPanelHeader;","import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport classNames from 'classnames';\r\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport VirtualizedList from 'components/NotesPanel/VirtualizedList';\r\nimport NormalList from 'components/NotesPanel/NormalList';\r\nimport Note from 'components/Note';\r\nimport Icon from 'components/Icon';\r\nimport NoteContext from 'components/Note/Context';\r\nimport ListSeparator from 'components/ListSeparator';\r\nimport MultiSelectControls from 'components/NotesPanel/MultiSelectControls';\r\nimport CustomElement from 'components/CustomElement';\r\nimport NotesPanelHeader from 'components/NotesPanelHeader';\r\nimport Choice from 'components/Choice';\r\n\r\nimport core from 'core';\r\nimport DataElements from 'constants/dataElement';\r\nimport { getSortStrategies } from 'constants/sortStrategies';\r\nimport { OFFICE_EDITOR_EDIT_MODE } from 'constants/officeEditor';\r\nimport actions from 'actions';\r\nimport selectors from 'selectors';\r\nimport { isMobileSize } from 'helpers/getDeviceSize';\r\nimport { isIE } from 'helpers/device';\r\nimport ReplyAttachmentPicker from './ReplyAttachmentPicker';\r\n\r\nimport './NotesPanel.scss';\r\n\r\nconst NotesPanel = ({\r\n  currentLeftPanelWidth,\r\n  notes,\r\n  selectedNoteIds,\r\n  setSelectedNoteIds,\r\n  searchInput,\r\n  setSearchInput,\r\n  isMultiSelectMode,\r\n  setMultiSelectMode,\r\n  isMultiSelectedMap,\r\n  setIsMultiSelectedMap,\r\n  scrollToSelectedAnnot,\r\n  setScrollToSelectedAnnot,\r\n  isCustomPanel,\r\n  isCustomPanelOpen,\r\n  isLeftSide,\r\n  parentDataElement,\r\n}) => {\r\n  const [\r\n    sortStrategy,\r\n    isOpen,\r\n    isDisabled,\r\n    pageLabels,\r\n    customNoteFilter,\r\n    currentNotesPanelWidth,\r\n    notesInLeftPanel,\r\n    isDocumentReadOnly,\r\n    showAnnotationNumbering,\r\n    enableNotesPanelVirtualizedList,\r\n    isInDesktopOnlyMode,\r\n    customEmptyPanel,\r\n    isNotesPanelMultiSelectEnabled,\r\n    activeDocumentViewerKey,\r\n    isOfficeEditorMode,\r\n  ] = useSelector(\r\n    (state) => [\r\n      selectors.getSortStrategy(state),\r\n      selectors.isElementOpen(state, DataElements.NOTES_PANEL),\r\n      selectors.isElementDisabled(state, DataElements.NOTES_PANEL),\r\n      selectors.getPageLabels(state),\r\n      selectors.getCustomNoteFilter(state),\r\n      parentDataElement ? selectors.getPanelWidth(state, parentDataElement) : selectors.getNotesPanelWidth(state),\r\n      selectors.getNotesInLeftPanel(state),\r\n      selectors.isDocumentReadOnly(state),\r\n      selectors.isAnnotationNumberingEnabled(state),\r\n      selectors.getEnableNotesPanelVirtualizedList(state),\r\n      selectors.isInDesktopOnlyMode(state),\r\n      selectors.getNotesPanelCustomEmptyPanel(state),\r\n      selectors.getIsNotesPanelMultiSelectEnabled(state),\r\n      selectors.getActiveDocumentViewerKey(state),\r\n      selectors.getIsOfficeEditorMode(state),\r\n    ],\r\n    shallowEqual,\r\n  );\r\n\r\n  const dispatch = useDispatch();\r\n  const [t] = useTranslation();\r\n\r\n  const currentWidth = currentLeftPanelWidth || currentNotesPanelWidth;\r\n  const isMobile = isMobileSize();\r\n\r\n  const [multiSelectedAnnotations, setMultiSelectedAnnotations] = useState([]);\r\n  const [showMultiReply, setShowMultiReply] = useState(false);\r\n  const [showMultiState, setShowMultiState] = useState(false);\r\n  const [showMultiStyle, setShowMultiStyle] = useState(false);\r\n  const [curAnnotId, setCurAnnotId] = useState(undefined);\r\n\r\n  const listRef = useRef();\r\n  // a ref that is used to keep track of the current scroll position\r\n  // when the number of notesToRender goes over/below the threshold, we will unmount the current list and mount the other one\r\n  // this will result in losing the scroll position and we will use this ref to recover\r\n  const scrollTopRef = useRef(0);\r\n  const VIRTUALIZATION_THRESHOLD = enableNotesPanelVirtualizedList ? (isIE ? 25 : 100) : Infinity;\r\n\r\n  useEffect(() => {\r\n    const onAnnotationNumberingUpdated = (isEnabled) => {\r\n      dispatch(actions.setAnnotationNumbering(isEnabled));\r\n    };\r\n    const onAnnotationSelected = (annotations, action) => {\r\n      if (action === 'selected') {\r\n        setCurAnnotId(annotations[0].Id);\r\n      }\r\n    };\r\n\r\n    core.addEventListener('annotationNumberingUpdated', onAnnotationNumberingUpdated);\r\n    core.addEventListener('annotationSelected', onAnnotationSelected);\r\n\r\n    return () => {\r\n      core.removeEventListener('annotationNumberingUpdated', onAnnotationNumberingUpdated);\r\n      core.removeEventListener('annotationSelected', onAnnotationSelected);\r\n    };\r\n  }, []);\r\n\r\n  let singleSelectedNoteIndex = -1;\r\n\r\n  const handleScroll = (scrollTop) => {\r\n    if (scrollTop) {\r\n      scrollTopRef.current = scrollTop;\r\n    }\r\n    dispatch(actions.closeElement('annotationNoteConnectorLine'));\r\n  };\r\n\r\n  const filterNotesWithSearch = (note) => {\r\n    const content = note.getContents();\r\n    const authorName = core.getDisplayAuthor(note['Author']);\r\n    const annotationPreview = note.getCustomData('trn-annot-preview');\r\n\r\n    // didn't use regex here because the search input may form an invalid regex, e.g. *\r\n    return (\r\n      content?.toLowerCase().includes(searchInput.toLowerCase()) ||\r\n      authorName?.toLowerCase().includes(searchInput.toLowerCase()) ||\r\n      annotationPreview?.toLowerCase().includes(searchInput.toLowerCase())\r\n    );\r\n  };\r\n\r\n  const filterNote = (note) => {\r\n    let shouldRender = true;\r\n\r\n    if (customNoteFilter) {\r\n      shouldRender = shouldRender && customNoteFilter(note);\r\n    }\r\n\r\n    if (searchInput) {\r\n      const replies = note.getReplies();\r\n      // reply is also a kind of annotation\r\n      // https://docs.apryse.com/api/web/Core.AnnotationManager.html#createAnnotationReply__anchor\r\n      const noteAndReplies = [note, ...replies];\r\n\r\n      shouldRender = shouldRender && noteAndReplies.some(filterNotesWithSearch);\r\n    }\r\n    return shouldRender;\r\n  };\r\n\r\n  const notesToRender = getSortStrategies()[sortStrategy].getSortedNotes(notes).filter(filterNote);\r\n\r\n  useEffect(() => {\r\n    if (Object.keys(selectedNoteIds).length && singleSelectedNoteIndex !== -1) {\r\n      setTimeout(() => {\r\n        // wait for the previous selected annotation to resize() after closing before scrolling to the newly selected one\r\n        listRef.current?.scrollToRow(singleSelectedNoteIndex);\r\n      }, 0);\r\n    }\r\n  }, [selectedNoteIds]);\r\n\r\n  // expand a reply note when search content is match\r\n  const onlyReplyContainsSearchInput = (currNote) => {\r\n    if (Object.keys(selectedNoteIds).length) {\r\n      return false;\r\n    }\r\n    return (\r\n      searchInput &&\r\n      notesToRender\r\n        .filter((note) => {\r\n          return note.getReplies().some(filterNotesWithSearch);\r\n        })\r\n        .some((replies) => replies.Id === currNote.Id)\r\n    );\r\n  };\r\n\r\n  const [pendingEditTextMap, setPendingEditTextMap] = useState({});\r\n  const setPendingEditText = useCallback(\r\n    (pendingText, annotationID) => {\r\n      setPendingEditTextMap((map) => ({\r\n        ...map,\r\n        [annotationID]: pendingText,\r\n      }));\r\n    },\r\n    [setPendingEditTextMap],\r\n  );\r\n\r\n  const [pendingReplyMap, setPendingReplyMap] = useState({});\r\n  const setPendingReply = useCallback(\r\n    (pendingReply, annotationID) => {\r\n      setPendingReplyMap((map) => ({\r\n        ...map,\r\n        [annotationID]: pendingReply,\r\n      }));\r\n    },\r\n    [setPendingReplyMap],\r\n  );\r\n\r\n  const [pendingAttachmentMap, setPendingAttachmentMap] = useState({});\r\n  const addAttachments = (annotationID, attachments) => {\r\n    setPendingAttachmentMap((map) => ({\r\n      ...map,\r\n      [annotationID]: [...(map[annotationID] || []), ...attachments],\r\n    }));\r\n  };\r\n  const clearAttachments = (annotationID) => {\r\n    setPendingAttachmentMap((map) => ({\r\n      ...map,\r\n      [annotationID]: [],\r\n    }));\r\n  };\r\n  const deleteAttachment = (annotationID, attachment) => {\r\n    const attachmentList = pendingAttachmentMap[annotationID];\r\n    if (attachmentList?.length > 0) {\r\n      const index = attachmentList.indexOf(attachment);\r\n      if (index > -1) {\r\n        attachmentList.splice(index, 1);\r\n        setPendingAttachmentMap((map) => ({\r\n          ...map,\r\n          [annotationID]: [...attachmentList],\r\n        }));\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    setMultiSelectedAnnotations(Object.values(isMultiSelectedMap));\r\n  }, [isMultiSelectedMap]);\r\n\r\n  const toggleMultiSelectMode = () => {\r\n    if (isMultiSelectMode) {\r\n      setMultiSelectMode(false);\r\n    } else {\r\n      setMultiSelectMode(true);\r\n    }\r\n  };\r\n\r\n  const renderChild = (\r\n    notes,\r\n    index,\r\n    // when we are virtualizing the notes, all of them will be absolutely positioned\r\n    // this function needs to be called by a Note component whenever its height changes\r\n    // to clear the cache(used by react-virtualized) and recompute the height so that each note\r\n    // can have the correct position\r\n    resize = () => { },\r\n  ) => {\r\n    let listSeparator = null;\r\n    const { shouldRenderSeparator, getSeparatorContent } = getSortStrategies()[sortStrategy];\r\n    const prevNote = index === 0 ? null : notes[index - 1];\r\n    const currNote = notes[index];\r\n\r\n    if (shouldRenderSeparator && getSeparatorContent && (!prevNote || shouldRenderSeparator(prevNote, currNote))) {\r\n      listSeparator = <ListSeparator renderContent={() => getSeparatorContent(prevNote, currNote, { pageLabels })} />;\r\n    }\r\n\r\n    // Collapse an expanded note when the top non-reply NoteContent is clicked\r\n    const handleNoteClicked = () => {\r\n      if (!isMultiSelectMode && selectedNoteIds[currNote.Id]) {\r\n        setSelectedNoteIds((currIds) => {\r\n          const clone = { ...currIds };\r\n          delete clone[currNote.Id];\r\n          return clone;\r\n        });\r\n        core.deselectAnnotation(currNote, activeDocumentViewerKey);\r\n      }\r\n    };\r\n\r\n    // can potentially optimize this a bit since a new reference will cause consumers to rerender\r\n    const contextValue = {\r\n      searchInput,\r\n      resize,\r\n      isSelected: selectedNoteIds[currNote.Id],\r\n      isContentEditable: core.canModifyContents(currNote, activeDocumentViewerKey) && !currNote.getContents(),\r\n      pendingEditTextMap,\r\n      setPendingEditText,\r\n      pendingReplyMap,\r\n      setPendingReply,\r\n      isDocumentReadOnly,\r\n      onTopNoteContentClicked: handleNoteClicked,\r\n      isExpandedFromSearch: onlyReplyContainsSearchInput(currNote),\r\n      scrollToSelectedAnnot,\r\n      sortStrategy,\r\n      showAnnotationNumbering,\r\n      setCurAnnotId,\r\n      pendingAttachmentMap,\r\n      clearAttachments,\r\n      deleteAttachment,\r\n      addAttachments,\r\n      documentViewerKey: activeDocumentViewerKey,\r\n    };\r\n\r\n    if (index === singleSelectedNoteIndex) {\r\n      setTimeout(() => {\r\n        setScrollToSelectedAnnot(false);\r\n        // open the 'annotationNoteConnectorLine' since the note it's pointing to is being rendered\r\n        dispatch(actions.openElement('annotationNoteConnectorLine'));\r\n      }, 0);\r\n    }\r\n\r\n    return (\r\n      // unfortunately we need to use an actual div instead of React.Fragment here so that we can pass the correct index to scrollToRow\r\n      // if this is a fragment then the listSeparator is rendered as a separate child, which means\r\n      // singleSelectedNoteIndex might not be the index of the selected note among all the child elements of the notes panel\r\n      <div role=\"listitem\" className=\"note-wrapper\">\r\n        {listSeparator}\r\n        <NoteContext.Provider value={contextValue}>\r\n          <Note\r\n            isCustomPanelOpen={isCustomPanelOpen}\r\n            shouldHideConnectorLine={isLeftSide}\r\n            annotation={currNote}\r\n            isMultiSelected={!!isMultiSelectedMap[currNote.Id]}\r\n            isMultiSelectMode={isMultiSelectMode}\r\n            isMultiSelectEnabled={isNotesPanelMultiSelectEnabled}\r\n            isInNotesPanel\r\n            handleMultiSelect={(checked) => {\r\n              if (checked) {\r\n                const _isMultiSelectedMap = { ...isMultiSelectedMap };\r\n                const groupAnnots = core.getGroupAnnotations(currNote, activeDocumentViewerKey);\r\n                groupAnnots.forEach((groupAnnot) => {\r\n                  _isMultiSelectedMap[groupAnnot.Id] = groupAnnot;\r\n                });\r\n                setIsMultiSelectedMap(_isMultiSelectedMap);\r\n                core.selectAnnotations(groupAnnots);\r\n              } else {\r\n                const _isMultiSelectedMap = { ...isMultiSelectedMap };\r\n                const groupAnnots = core.getGroupAnnotations(currNote, activeDocumentViewerKey);\r\n                groupAnnots.forEach((groupAnnot) => {\r\n                  delete _isMultiSelectedMap[groupAnnot.Id];\r\n                });\r\n                setIsMultiSelectedMap(_isMultiSelectedMap);\r\n                core.deselectAnnotations([currNote, ...groupAnnots]);\r\n              }\r\n            }}\r\n          />\r\n        </NoteContext.Provider>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const NoResults = (\r\n    <div className=\"no-results\">\r\n      <div>\r\n        <Icon className=\"empty-icon\" glyph=\"illustration - empty state - outlines\" />\r\n      </div>\r\n      <div className=\"msg\">{t('message.noResults')}</div>\r\n    </div>\r\n  );\r\n\r\n  const NoAnnotationsGlyph = customEmptyPanel?.icon ?\r\n    customEmptyPanel.icon :\r\n    (isOfficeEditorMode ? 'ic-edit-page' : 'illustration - empty state - outlines');\r\n  const NoAnnotationsMessage = customEmptyPanel?.message ?\r\n    customEmptyPanel.message :\r\n    (isOfficeEditorMode ? t('message.noRevisions') : t('message.noAnnotations'));\r\n  const NoAnnotationsReadOnlyMessage =\r\n    customEmptyPanel && customEmptyPanel.readOnlyMessage\r\n      ? customEmptyPanel.readOnlyMessage\r\n      : t('message.noAnnotationsReadOnly');\r\n  const shouldRenderNoAnnotationsIcon = (customEmptyPanel && !customEmptyPanel.hideIcon) || !customEmptyPanel;\r\n  const shouldRenderCustomEmptyPanel = customEmptyPanel && customEmptyPanel.render;\r\n\r\n  const NoAnnotations = (\r\n    <div className=\"no-annotations\">\r\n      {shouldRenderCustomEmptyPanel ? (\r\n        <CustomElement render={customEmptyPanel.render} />\r\n      ) : (\r\n        <>\r\n          {shouldRenderNoAnnotationsIcon && (\r\n            <div>\r\n              <Icon className=\"empty-icon\" glyph={NoAnnotationsGlyph} />\r\n            </div>\r\n          )}\r\n          <div className=\"msg\">{isDocumentReadOnly ? NoAnnotationsReadOnlyMessage : NoAnnotationsMessage}</div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const MultiSelectPlaceHolder = <div className=\"multi-select-place-holder\" />;\r\n\r\n  const MultiReplyPlaceHolder = <div className=\"multi-reply-place-holder\" />;\r\n\r\n  // keep track of the index of the single selected note in the sorted and filtered list\r\n  // in order to scroll it into view in this render effect\r\n  const ids = Object.keys(selectedNoteIds);\r\n  if (ids.length === 1) {\r\n    singleSelectedNoteIndex = notesToRender.findIndex((note) => note.Id === ids[0]);\r\n  } else if (ids.length) {\r\n    // when selecting annotations that are grouped together, scroll to parent annotation that is in \"notesToRender\"\r\n    // selectedNoteIds will have every ID in the group, while only the parent is in notesToRender\r\n    const existingSelectedNotes = notesToRender.filter((note) => selectedNoteIds[note.Id]);\r\n\r\n    if (existingSelectedNotes.length) {\r\n      singleSelectedNoteIndex = notesToRender.findIndex((note) => note.Id === curAnnotId);\r\n    }\r\n  }\r\n\r\n  let style = {};\r\n  if (!isCustomPanel && (isInDesktopOnlyMode || !isMobile)) {\r\n    style = { width: `${currentWidth}px`, minWidth: `${currentWidth}px` };\r\n  }\r\n\r\n  const showNotePanel = !isDisabled && (isOpen || notesInLeftPanel || isCustomPanel);\r\n\r\n  return !showNotePanel ? null : (\r\n    <div className=\"notes-panel-container\">\r\n      <div\r\n        className={classNames({\r\n          Panel: true,\r\n          NotesPanel: true,\r\n        })}\r\n        style={style}\r\n        data-element=\"notesPanel\"\r\n        onMouseUp={() => core.deselectAllAnnotations}\r\n      >\r\n        {!isInDesktopOnlyMode && isMobile && !notesInLeftPanel && (\r\n          <div className=\"close-container\">\r\n            <div\r\n              className=\"close-icon-container\"\r\n              onClick={() => {\r\n                dispatch(actions.closeElements([DataElements.NOTES_PANEL]));\r\n              }}\r\n            >\r\n              <Icon glyph=\"ic_close_black_24px\" className=\"close-icon\" />\r\n            </div>\r\n          </div>\r\n        )}\r\n        <>\r\n          <NotesPanelHeader\r\n            notes={notesToRender}\r\n            disableFilterAnnotation={notes.length === 0}\r\n            setSearchInputHandler={setSearchInput}\r\n            isMultiSelectMode={isMultiSelectMode}\r\n            toggleMultiSelectMode={toggleMultiSelectMode}\r\n            isMultiSelectEnabled={isNotesPanelMultiSelectEnabled}\r\n          />\r\n          {notesToRender.length === 0 ? (\r\n            notes.length === 0 ? (\r\n              NoAnnotations\r\n            ) : (\r\n              NoResults\r\n            )\r\n          ) : notesToRender.length <= VIRTUALIZATION_THRESHOLD ? (\r\n            <NormalList\r\n              ref={listRef}\r\n              notes={notesToRender}\r\n              onScroll={handleScroll}\r\n              initialScrollTop={scrollTopRef.current}\r\n            >\r\n              {renderChild}\r\n            </NormalList>\r\n          ) : (\r\n            <VirtualizedList\r\n              ref={listRef}\r\n              notes={notesToRender}\r\n              sortStrategy={sortStrategy}\r\n              onScroll={handleScroll}\r\n              initialScrollTop={scrollTopRef.current}\r\n              selectedIndex={singleSelectedNoteIndex}\r\n            >\r\n              {renderChild}\r\n            </VirtualizedList>\r\n          )}\r\n          {/* These two placeholders need to exist so that MultiSelectControls can\r\n          be overlayed with position absolute and extend into the right panel while\r\n          still being able to not have any notes cut off */}\r\n          {isMultiSelectMode ? (showMultiReply ? MultiReplyPlaceHolder : MultiSelectPlaceHolder) : null}\r\n          {isOfficeEditorMode && !isMultiSelectMode && (notesToRender.length > 0) && (\r\n            <div className=\"preview-all-changes\">\r\n              <div className=\"divider\" />\r\n              <Choice\r\n                isSwitch\r\n                label={t('officeEditor.previewAllChanges')}\r\n                onChange={(e) => core.getOfficeEditor().setEditMode(e.target.checked ? OFFICE_EDITOR_EDIT_MODE.PREVIEW : OFFICE_EDITOR_EDIT_MODE.REVIEWING)}\r\n              />\r\n            </div>\r\n          )}\r\n        </>\r\n      </div>\r\n      {isMultiSelectMode && (\r\n        <MultiSelectControls\r\n          showMultiReply={showMultiReply}\r\n          setShowMultiReply={setShowMultiReply}\r\n          showMultiState={showMultiState}\r\n          setShowMultiState={setShowMultiState}\r\n          showMultiStyle={showMultiStyle}\r\n          setShowMultiStyle={setShowMultiStyle}\r\n          setMultiSelectMode={setMultiSelectMode}\r\n          isMultiSelectedMap={isMultiSelectedMap}\r\n          setIsMultiSelectedMap={setIsMultiSelectedMap}\r\n          multiSelectedAnnotations={multiSelectedAnnotations}\r\n        />\r\n      )}\r\n      <ReplyAttachmentPicker annotationId={curAnnotId} addAttachments={addAttachments} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotesPanel;\r\n","import React, { useEffect, useState, useCallback } from 'react';\r\nimport core from 'core';\r\nimport NotesPanel from './NotesPanel';\r\nimport { useSelector, shallowEqual } from 'react-redux';\r\nimport selectors from 'selectors';\r\nimport DataElements from 'constants/dataElement';\r\nimport { mapAnnotationToKey, annotationMapKeys } from 'constants/map';\r\n\r\nfunction NotesPanelContainer(props) {\r\n  const { isCustomPanelOpen, parentDataElement = undefined, dataElement } = props;\r\n  const [\r\n    isOpen,\r\n    notesInLeftPanel,\r\n    isNotesPanelMultiSelectEnabled,\r\n    isMultiViewerMode,\r\n    activeDocumentViewerKey,\r\n    isOfficeEditorMode,\r\n  ] = useSelector(\r\n    (state) => [\r\n      selectors.isElementOpen(state, parentDataElement || dataElement || DataElements.NOTES_PANEL),\r\n      selectors.getNotesInLeftPanel(state),\r\n      selectors.getIsNotesPanelMultiSelectEnabled(state),\r\n      selectors.isMultiViewerMode(state),\r\n      selectors.getActiveDocumentViewerKey(state),\r\n      selectors.getIsOfficeEditorMode(state),\r\n    ],\r\n    shallowEqual,\r\n  );\r\n  const [searchInput, setSearchInput] = useState('');\r\n  const [isMultiSelectMode, setMultiSelectMode] = useState(false);\r\n  const [scrollToSelectedAnnot, setScrollToSelectedAnnot] = useState(false);\r\n\r\n  const [noteMap, setNoteMap] = useState({ 1: [], 2: [] });\r\n  const setNotes = useCallback((notes, documentViewerKey = activeDocumentViewerKey) => {\r\n    noteMap[documentViewerKey] = notes;\r\n    setNoteMap({ ...noteMap });\r\n  }, [activeDocumentViewerKey, noteMap[1], noteMap[2], setNoteMap]);\r\n  const notes = noteMap[activeDocumentViewerKey] || noteMap[1];\r\n\r\n  // the object will be in a shape of { [note.Id]: true }\r\n  // use a map here instead of an array to achieve an O(1) time complexity for checking if a note is selected\r\n  const [selectedNoteIdsMap, setSelectedNoteIdsMap] = useState({ 1: {}, 2: {}, });\r\n  const setSelectedNoteIds = useCallback((selectedNoteIds, documentViewerKey = activeDocumentViewerKey) => {\r\n    selectedNoteIdsMap[documentViewerKey] = selectedNoteIds;\r\n    setSelectedNoteIdsMap({ ...selectedNoteIdsMap });\r\n  }, [activeDocumentViewerKey, selectedNoteIdsMap[1], selectedNoteIdsMap[2], setSelectedNoteIdsMap]);\r\n  const selectedNoteIds = selectedNoteIdsMap[activeDocumentViewerKey] || selectedNoteIdsMap[1];\r\n\r\n  const [isMultiSelectedViewerMap, setIsMultiSelectedViewerMap] = useState({ 1: {}, 2: {}, });\r\n  const setIsMultiSelectedMap = useCallback((isMultiSelected, documentViewerKey = activeDocumentViewerKey) => {\r\n    isMultiSelectedViewerMap[documentViewerKey] = isMultiSelected;\r\n    setIsMultiSelectedViewerMap({ ...isMultiSelectedViewerMap });\r\n  }, [activeDocumentViewerKey, isMultiSelectedViewerMap[1], isMultiSelectedViewerMap[2], setIsMultiSelectedViewerMap]);\r\n  const isMultiSelectedMap = isMultiSelectedViewerMap[activeDocumentViewerKey] || isMultiSelectedViewerMap[1];\r\n\r\n  useEffect(() => {\r\n    const onDocumentUnloaded = (documentViewerKey = activeDocumentViewerKey) => () => {\r\n      setNotes([], documentViewerKey);\r\n      setSelectedNoteIds({});\r\n      setSearchInput('');\r\n    };\r\n    const _setNotes = (documentViewerKey = activeDocumentViewerKey) => () => {\r\n      const selectedAnnotations = core.getSelectedAnnotations(documentViewerKey);\r\n      const groupedAnnots = getGroupedAnnots(selectedAnnotations);\r\n\r\n      if (isMultiSelectMode && groupedAnnots.length === selectedAnnotations.length) {\r\n        setMultiSelectMode(false);\r\n      }\r\n\r\n      setNotes(\r\n        core\r\n          .getAnnotationsList(documentViewerKey)\r\n          .filter(\r\n            (annot) => annot.Listable &&\r\n              !annot.isReply() &&\r\n              !annot.Hidden &&\r\n              !annot.isGrouped() &&\r\n              annot.ToolName !== window.Core.Tools.ToolNames.CROP &&\r\n              !annot.isContentEditPlaceholder() &&\r\n              (!isOfficeEditorMode || mapAnnotationToKey(annot) === annotationMapKeys.TRACKED_CHANGE),\r\n          ),\r\n        documentViewerKey,\r\n      );\r\n    };\r\n\r\n    const setDocumentUnloaded1 = onDocumentUnloaded(1);\r\n    core.addEventListener('documentUnloaded', setDocumentUnloaded1);\r\n    const setNotes1 = _setNotes(1);\r\n    core.addEventListener('annotationChanged', setNotes1);\r\n    core.addEventListener('annotationHidden', setNotes1);\r\n    core.addEventListener('updateAnnotationPermission', setNotes1);\r\n    setNotes1();\r\n\r\n    let setDocumentUnloaded2;\r\n    let setNotes2;\r\n    if (isMultiViewerMode) {\r\n      setDocumentUnloaded2 = onDocumentUnloaded(2);\r\n      core.addEventListener('documentUnloaded', setDocumentUnloaded2, undefined, 2);\r\n      setNotes2 = _setNotes(2);\r\n      core.addEventListener('annotationChanged', setNotes2, undefined, 2);\r\n      core.addEventListener('annotationHidden', setNotes2, undefined, 2);\r\n      core.addEventListener('updateAnnotationPermission', setNotes2, undefined, 2);\r\n      setNotes2();\r\n    }\r\n\r\n    return () => {\r\n      if (isMultiViewerMode) {\r\n        core.removeEventListener('documentUnloaded', setDocumentUnloaded2, 2);\r\n        core.removeEventListener('annotationChanged', setNotes2, 2);\r\n        core.removeEventListener('annotationHidden', setNotes2, 2);\r\n        core.removeEventListener('updateAnnotationPermission', setNotes2, 2);\r\n      }\r\n      core.removeEventListener('documentUnloaded', setDocumentUnloaded1);\r\n      core.removeEventListener('annotationChanged', setNotes1);\r\n      core.removeEventListener('annotationHidden', setNotes1);\r\n      core.removeEventListener('updateAnnotationPermission', setNotes1);\r\n    };\r\n  }, [isMultiViewerMode, isOfficeEditorMode]);\r\n\r\n  useEffect(() => {\r\n    const onAnnotationSelected = (documentViewerKey = activeDocumentViewerKey) => (annotations, action) => {\r\n      const selectedAnnotations = core.getSelectedAnnotations(documentViewerKey);\r\n      const ids = {};\r\n      selectedAnnotations.forEach((annot) => {\r\n        ids[annot.Id] = true;\r\n      });\r\n      if (isCustomPanelOpen || isOpen || notesInLeftPanel) {\r\n        setSelectedNoteIds(ids, documentViewerKey);\r\n        setScrollToSelectedAnnot(true);\r\n      }\r\n      const groupedAnnots = getGroupedAnnots(selectedAnnotations);\r\n      const shouldDisplayMultiSelect = (selectedAnnotations.length > 1 && groupedAnnots.length !== selectedAnnotations.length) || isMultiSelectMode;\r\n\r\n      if (isNotesPanelMultiSelectEnabled\r\n        && action === 'selected'\r\n        && shouldDisplayMultiSelect) {\r\n        setMultiSelectMode(true);\r\n        selectedAnnotations.forEach((selectedAnnot) => {\r\n          isMultiSelectedMap[selectedAnnot.Id] = selectedAnnot;\r\n        });\r\n        setIsMultiSelectedMap({ ...isMultiSelectedMap }, documentViewerKey);\r\n      } else if (action === 'deselected') {\r\n        annotations.forEach((a) => {\r\n          delete isMultiSelectedMap[a.Id];\r\n        });\r\n        setIsMultiSelectedMap({ ...isMultiSelectedMap }, documentViewerKey);\r\n      }\r\n    };\r\n    const onAnnotationSelected1 = onAnnotationSelected(1);\r\n    onAnnotationSelected1();\r\n    core.addEventListener('annotationSelected', onAnnotationSelected1);\r\n    let onAnnotationSelected2;\r\n    if (isMultiViewerMode) {\r\n      onAnnotationSelected2 = onAnnotationSelected(2);\r\n      onAnnotationSelected2();\r\n      core.addEventListener('annotationSelected', onAnnotationSelected2, undefined, 2);\r\n    }\r\n    return () => {\r\n      core.removeEventListener('annotationSelected', onAnnotationSelected1);\r\n      if (isMultiViewerMode) {\r\n        core.removeEventListener('annotationSelected', onAnnotationSelected2, 2);\r\n      }\r\n    };\r\n  }, [isCustomPanelOpen, isOpen, notesInLeftPanel, isMultiSelectMode, isMultiSelectedMap, isNotesPanelMultiSelectEnabled, isMultiViewerMode]);\r\n\r\n  function getGroupedAnnots(selectedAnnotations) {\r\n    const mainAnnot = selectedAnnotations.find((annot) => annot.isGrouped());\r\n    const groupedAnnots = [];\r\n\r\n    // check if all selected annots are grouped annotations\r\n    if (mainAnnot) {\r\n      selectedAnnotations.forEach((annot) => {\r\n        if (mainAnnot['InReplyTo'] === annot['InReplyTo']\r\n          || mainAnnot['InReplyTo'] === annot['Id']) {\r\n          groupedAnnots.push(annot);\r\n        }\r\n      });\r\n    }\r\n    return groupedAnnots;\r\n  }\r\n\r\n  const passProps = {\r\n    notes,\r\n    selectedNoteIds,\r\n    setSelectedNoteIds,\r\n    searchInput,\r\n    setSearchInput,\r\n    isMultiSelectMode,\r\n    setMultiSelectMode,\r\n    isMultiSelectedMap,\r\n    setIsMultiSelectedMap,\r\n    scrollToSelectedAnnot,\r\n    setScrollToSelectedAnnot,\r\n  };\r\n\r\n  // We wrap the element in a div so the tooltip works properly\r\n  return (\r\n    <NotesPanel {...props} {...passProps} />\r\n  );\r\n}\r\n\r\nexport default NotesPanelContainer;\r\n","import NotesPanelContainer from './NotesPanelContainer';\r\n\r\nexport default NotesPanelContainer;\r\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.multi-reply-place-holder{height:100px}.reply-area-multi-container{border-top:1px solid var(--divider);display:flex;flex-direction:column;width:100%;position:absolute;bottom:0;z-index:100;background:var(--panel-background)}.reply-area-multi-container form{width:100%;display:flex}.reply-area-multi-container .reply-area-multi-header{display:flex;flex-direction:row;margin-left:16px;margin-top:28px;position:relative;justify-content:space-between}.reply-area-multi-container .reply-area-multi-header .title{font-size:13px;font-weight:700;display:flex;align-items:center}.reply-area-multi-container .reply-area-multi-header .close-icon-container{display:flex;align-items:center;padding-right:12px;cursor:pointer;position:relative;top:1px}.reply-area-multi-container .reply-area-multi-header .close-icon-container .close-icon{width:22px;height:22px}.reply-area-multi-container .reply-button-container{display:flex;justify-content:flex-end;flex-direction:column}.reply-area-multi-container .reply-button{width:28px;height:28px;padding:0;border:none;background-color:transparent;right:10px;bottom:12px}:host(:not([data-tabbing=true])) .reply-area-multi-container .reply-button,html:not([data-tabbing=true]) .reply-area-multi-container .reply-button{outline:none}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.reply-area-multi-container .reply-button{width:80px}}.reply-area-multi-container .reply-button:hover{background:var(--blue-1)}.reply-area-multi-container .reply-button.disabled{cursor:not-allowed}.reply-area-multi-container .reply-area{position:relative;flex:1;margin:13px 17px 12px 16px;border-radius:4px;align-items:center;background:var(--component-background)}.reply-area-multi-container .reply-area.unread{background:rgba(0,165,228,.08)}.reply-area-multi-container .reply-area .comment-textarea .ql-container .ql-editor.ql-blank{padding:4px}.reply-area-multi-container .reply-area .comment-textarea .ql-container .ql-editor.ql-blank:before{left:4px}.reply-area-multi-container .add-attachment{display:none}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".comments-counter{height:19px;margin-top:24px;margin-bottom:12px;font-size:16px}.comments-counter span{font-weight:700}[data-element=notesPanelHeader]{padding-right:18px}[data-element=notesPanelHeader] .buttons-container{display:flex;grid-column-gap:8px;-moz-column-gap:8px;column-gap:8px;justify-content:space-between}[data-element=notesPanelHeader] .buttons-container .Button{height:28px;width:28px;cursor:pointer}[data-element=notesPanelHeader] .buttons-container .Button:hover:enabled{background:var(--view-header-button-hover)}[data-element=notesPanelHeader] .buttons-container .Button.active{background:var(--view-header-button-active)}[data-element=notesPanelHeader] .buttons-container .Button.active .Icon{color:var(--view-header-icon-active-fill)}[data-element=notesPanelHeader] .sort-row{display:flex;justify-content:space-between;margin-bottom:16px}[data-element=notesPanelHeader] .sort-row .sort-container{display:flex;flex-direction:row;align-items:center;justify-content:flex-end;align-self:flex-end}[data-element=notesPanelHeader] .sort-row .sort-container .label{margin-right:8px}[data-element=notesPanelHeader] .sort-row .sort-container .picked-option{text-align:left}[data-element=notesPanelHeader] .input-container{display:flex;position:relative;flex:1}[data-element=notesPanelHeader] .input-container input{width:100%;border:1px solid var(--border);border-radius:4px;color:var(--text-color);padding:4px 8px 6px}[data-element=notesPanelHeader] .input-container input:focus{outline:none;border:1px solid var(--focus-border)}[data-element=notesPanelHeader] .input-container input::-moz-placeholder{color:var(--placeholder-text)}[data-element=notesPanelHeader] .input-container input::placeholder{color:var(--placeholder-text)}[data-element=notesPanelHeader] .input-container .input-button{cursor:pointer;background:var(--primary-button);border-radius:4px;height:100%;width:40px;display:flex;align-items:center;justify-content:center;position:absolute;bottom:0;right:0}[data-element=notesPanelHeader] .input-container .input-button .Icon{width:20px;height:20px}[data-element=notesPanelHeader] .input-container .input-button svg{color:var(--primary-button-text)}[data-element=notesPanelHeader] .input-container .input-button:hover{background:var(--primary-button-hover)}[data-element=notesPanelHeader] .divider{height:1px;width:100%;background:var(--divider);margin:16px 0}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".notes-panel-container .buttons-container{display:flex;grid-column-gap:8px;-moz-column-gap:8px;column-gap:8px;justify-content:space-between}.notes-panel-container .buttons-container .Button{height:28px;width:28px}.notes-panel-container .buttons-container .Button:hover:enabled{background:var(--view-header-button-hover)}.notes-panel-container .buttons-container .Button.active{background:var(--view-header-button-active)}.notes-panel-container .buttons-container .Button.active .Icon{color:var(--view-header-icon-active-fill)}.notes-panel-container .multi-select-footer{background:var(--panel-background);display:flex;border-top:1px solid var(--gray-5);margin-top:auto;height:72px;align-items:center;justify-content:center;position:absolute;bottom:0;width:100%;z-index:100}.notes-panel-container .multi-select-footer .close-container{margin-top:auto;right:10px;position:absolute}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".multi-style-container{border-radius:4px;box-shadow:0 0 3px 0 var(--document-box-shadow);background:var(--component-background);position:relative;right:20px;bottom:52px;pointer-events:auto}.multi-style-container *{box-sizing:border-box}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.notes-panel-container{z-index:65;display:flex;flex-direction:row;position:relative;overflow:hidden}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .notes-panel-container{z-index:95}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .notes-panel-container{z-index:95}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .notes-panel-container{border-left:1px solid var(--side-panel-border)}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .notes-panel-container{border-left:1px solid var(--side-panel-border)}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .notes-panel-container{position:fixed;top:0;right:0;height:100%;width:100%}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .notes-panel-container{position:fixed;top:0;right:0;height:100%;width:100%}}.notes-panel-container .NotesPanel{width:100%;padding-left:16px;padding-bottom:0;display:flex;flex-direction:column;position:relative;padding-top:16px}.notes-panel-container .NotesPanel .close-container{display:flex;align-items:center;justify-content:flex-end}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .notes-panel-container .NotesPanel .close-container{height:64px;padding-right:12px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .notes-panel-container .NotesPanel .close-container{height:64px;padding-right:12px}}.notes-panel-container .NotesPanel .close-container .close-icon-container{display:flex;align-items:center;cursor:pointer}.notes-panel-container .NotesPanel .close-container .close-icon-container .close-icon{width:24px;height:24px}.notes-panel-container .NotesPanel .multi-select-place-holder{height:72px}.notes-panel-container .NotesPanel .preview-all-changes{height:57px;display:flex;flex-direction:column;justify-content:center;position:relative;margin-right:16px}.notes-panel-container .NotesPanel .preview-all-changes .divider{height:1px;width:100%;background:var(--divider);position:absolute;top:0}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.notes-panel-container .NotesPanel .reply-area-container .reply-button{width:28px}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .notes-panel-container .NotesPanel{width:100%;min-width:100%;padding-top:0}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .notes-panel-container .NotesPanel{width:100%;min-width:100%;padding-top:0}}.notes-panel-container .NotesPanel .no-annotations{display:flex;flex-direction:column;align-items:center}.notes-panel-container .NotesPanel .no-annotations .msg{text-align:center}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .notes-panel-container .NotesPanel .no-annotations .msg{line-height:15px;width:146px}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .notes-panel-container .NotesPanel .no-annotations .msg{line-height:15px;width:146px}}.notes-panel-container .NotesPanel .no-annotations .empty-icon,.notes-panel-container .NotesPanel .no-annotations .empty-icon svg{width:65px;height:83px}.notes-panel-container .NotesPanel .no-annotations .empty-icon *{fill:var(--gray-5);color:var(--gray-5)}.notes-panel-container .NotesPanel .normal-notes-container,.notes-panel-container .NotesPanel .virtualized-notes-container{margin-top:10px;flex:1;padding-right:18px}.notes-panel-container .NotesPanel .virtualized-notes-container{overflow:hidden}.notes-panel-container .NotesPanel .normal-notes-container{overflow:auto;overflow:overlay}.notes-panel-container .NotesPanel .note-wrapper:first-child .ListSeparator{margin-top:0;word-break:break-word}.notes-panel-container .NotesPanel .no-results{display:flex;flex-direction:column;align-items:center;padding-right:18px}.notes-panel-container .NotesPanel .no-results .msg{text-align:center}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .notes-panel-container .NotesPanel .no-results .msg{line-height:15px;width:92px}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .notes-panel-container .NotesPanel .no-results .msg{line-height:15px;width:92px}}.notes-panel-container .NotesPanel .no-results .empty-icon,.notes-panel-container .NotesPanel .no-results .empty-icon svg{width:65px;height:83px}.notes-panel-container .NotesPanel .no-results .empty-icon *{fill:var(--border);color:var(--border)}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};\nmodule.exports = exports;\n","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/postcss-loader/src/index.js??ruleSet[1].rules[1].use[2]!../../../../node_modules/sass-loader/dist/cjs.js!./ReplyAreaMultiSelect.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\r\n                function findNestedWebComponents(tagName, root = document) {\r\n                  const elements = [];\r\n\r\n                  // Check direct children\r\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\r\n\r\n                  // Check shadow DOMs\r\n                  root.querySelectorAll('*').forEach(el => {\r\n                    if (el.shadowRoot) {\r\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\r\n                    }\r\n                  });\r\n\r\n                  return elements;\r\n                }\r\n                if (!window.isApryseWebViewerWebComponent) {\r\n                  document.head.appendChild(styleTag);\r\n                  return;\r\n                }\r\n\r\n                let webComponents;\r\n                // First we see if the webcomponent is at the document level\r\n                webComponents = document.getElementsByTagName('apryse-webviewer');\r\n                // If not, we check have to check if it is nested in another webcomponent\r\n                if (!webComponents.length) {\r\n                  webComponents = findNestedWebComponents('apryse-webviewer');\r\n                }\r\n                // Now we append the style tag to each webcomponent\r\n                const clonedStyleTags = [];\r\n                for (let i = 0; i < webComponents.length; i++) {\r\n                  const webComponent = webComponents[i];\r\n                  if (i === 0) {\r\n                    webComponent.shadowRoot.appendChild(styleTag);\r\n                    styleTag.onload = function () {\r\n                      if (clonedStyleTags.length > 0) {\r\n                        clonedStyleTags.forEach((styleNode) => {\r\n                          // eslint-disable-next-line no-unsanitized/property\r\n                          styleNode.innerHTML = styleTag.innerHTML;\r\n                        });\r\n                      }\r\n                    };\r\n                  } else {\r\n                    const styleNode = styleTag.cloneNode(true);\r\n                    webComponent.shadowRoot.appendChild(styleNode);\r\n                    clonedStyleTags.push(styleNode);\r\n                  }\r\n                }\r\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ruleSet[1].rules[1].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./NotesPanelHeader.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\r\n                function findNestedWebComponents(tagName, root = document) {\r\n                  const elements = [];\r\n\r\n                  // Check direct children\r\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\r\n\r\n                  // Check shadow DOMs\r\n                  root.querySelectorAll('*').forEach(el => {\r\n                    if (el.shadowRoot) {\r\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\r\n                    }\r\n                  });\r\n\r\n                  return elements;\r\n                }\r\n                if (!window.isApryseWebViewerWebComponent) {\r\n                  document.head.appendChild(styleTag);\r\n                  return;\r\n                }\r\n\r\n                let webComponents;\r\n                // First we see if the webcomponent is at the document level\r\n                webComponents = document.getElementsByTagName('apryse-webviewer');\r\n                // If not, we check have to check if it is nested in another webcomponent\r\n                if (!webComponents.length) {\r\n                  webComponents = findNestedWebComponents('apryse-webviewer');\r\n                }\r\n                // Now we append the style tag to each webcomponent\r\n                const clonedStyleTags = [];\r\n                for (let i = 0; i < webComponents.length; i++) {\r\n                  const webComponent = webComponents[i];\r\n                  if (i === 0) {\r\n                    webComponent.shadowRoot.appendChild(styleTag);\r\n                    styleTag.onload = function () {\r\n                      if (clonedStyleTags.length > 0) {\r\n                        clonedStyleTags.forEach((styleNode) => {\r\n                          // eslint-disable-next-line no-unsanitized/property\r\n                          styleNode.innerHTML = styleTag.innerHTML;\r\n                        });\r\n                      }\r\n                    };\r\n                  } else {\r\n                    const styleNode = styleTag.cloneNode(true);\r\n                    webComponent.shadowRoot.appendChild(styleNode);\r\n                    clonedStyleTags.push(styleNode);\r\n                  }\r\n                }\r\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ruleSet[1].rules[1].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./MultiSelectControls.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\r\n                function findNestedWebComponents(tagName, root = document) {\r\n                  const elements = [];\r\n\r\n                  // Check direct children\r\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\r\n\r\n                  // Check shadow DOMs\r\n                  root.querySelectorAll('*').forEach(el => {\r\n                    if (el.shadowRoot) {\r\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\r\n                    }\r\n                  });\r\n\r\n                  return elements;\r\n                }\r\n                if (!window.isApryseWebViewerWebComponent) {\r\n                  document.head.appendChild(styleTag);\r\n                  return;\r\n                }\r\n\r\n                let webComponents;\r\n                // First we see if the webcomponent is at the document level\r\n                webComponents = document.getElementsByTagName('apryse-webviewer');\r\n                // If not, we check have to check if it is nested in another webcomponent\r\n                if (!webComponents.length) {\r\n                  webComponents = findNestedWebComponents('apryse-webviewer');\r\n                }\r\n                // Now we append the style tag to each webcomponent\r\n                const clonedStyleTags = [];\r\n                for (let i = 0; i < webComponents.length; i++) {\r\n                  const webComponent = webComponents[i];\r\n                  if (i === 0) {\r\n                    webComponent.shadowRoot.appendChild(styleTag);\r\n                    styleTag.onload = function () {\r\n                      if (clonedStyleTags.length > 0) {\r\n                        clonedStyleTags.forEach((styleNode) => {\r\n                          // eslint-disable-next-line no-unsanitized/property\r\n                          styleNode.innerHTML = styleTag.innerHTML;\r\n                        });\r\n                      }\r\n                    };\r\n                  } else {\r\n                    const styleNode = styleTag.cloneNode(true);\r\n                    webComponent.shadowRoot.appendChild(styleNode);\r\n                    clonedStyleTags.push(styleNode);\r\n                  }\r\n                }\r\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ruleSet[1].rules[1].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./MultiStylePopup.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\r\n                function findNestedWebComponents(tagName, root = document) {\r\n                  const elements = [];\r\n\r\n                  // Check direct children\r\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\r\n\r\n                  // Check shadow DOMs\r\n                  root.querySelectorAll('*').forEach(el => {\r\n                    if (el.shadowRoot) {\r\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\r\n                    }\r\n                  });\r\n\r\n                  return elements;\r\n                }\r\n                if (!window.isApryseWebViewerWebComponent) {\r\n                  document.head.appendChild(styleTag);\r\n                  return;\r\n                }\r\n\r\n                let webComponents;\r\n                // First we see if the webcomponent is at the document level\r\n                webComponents = document.getElementsByTagName('apryse-webviewer');\r\n                // If not, we check have to check if it is nested in another webcomponent\r\n                if (!webComponents.length) {\r\n                  webComponents = findNestedWebComponents('apryse-webviewer');\r\n                }\r\n                // Now we append the style tag to each webcomponent\r\n                const clonedStyleTags = [];\r\n                for (let i = 0; i < webComponents.length; i++) {\r\n                  const webComponent = webComponents[i];\r\n                  if (i === 0) {\r\n                    webComponent.shadowRoot.appendChild(styleTag);\r\n                    styleTag.onload = function () {\r\n                      if (clonedStyleTags.length > 0) {\r\n                        clonedStyleTags.forEach((styleNode) => {\r\n                          // eslint-disable-next-line no-unsanitized/property\r\n                          styleNode.innerHTML = styleTag.innerHTML;\r\n                        });\r\n                      }\r\n                    };\r\n                  } else {\r\n                    const styleNode = styleTag.cloneNode(true);\r\n                    webComponent.shadowRoot.appendChild(styleNode);\r\n                    clonedStyleTags.push(styleNode);\r\n                  }\r\n                }\r\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ruleSet[1].rules[1].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./NotesPanel.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\r\n                function findNestedWebComponents(tagName, root = document) {\r\n                  const elements = [];\r\n\r\n                  // Check direct children\r\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\r\n\r\n                  // Check shadow DOMs\r\n                  root.querySelectorAll('*').forEach(el => {\r\n                    if (el.shadowRoot) {\r\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\r\n                    }\r\n                  });\r\n\r\n                  return elements;\r\n                }\r\n                if (!window.isApryseWebViewerWebComponent) {\r\n                  document.head.appendChild(styleTag);\r\n                  return;\r\n                }\r\n\r\n                let webComponents;\r\n                // First we see if the webcomponent is at the document level\r\n                webComponents = document.getElementsByTagName('apryse-webviewer');\r\n                // If not, we check have to check if it is nested in another webcomponent\r\n                if (!webComponents.length) {\r\n                  webComponents = findNestedWebComponents('apryse-webviewer');\r\n                }\r\n                // Now we append the style tag to each webcomponent\r\n                const clonedStyleTags = [];\r\n                for (let i = 0; i < webComponents.length; i++) {\r\n                  const webComponent = webComponents[i];\r\n                  if (i === 0) {\r\n                    webComponent.shadowRoot.appendChild(styleTag);\r\n                    styleTag.onload = function () {\r\n                      if (clonedStyleTags.length > 0) {\r\n                        clonedStyleTags.forEach((styleNode) => {\r\n                          // eslint-disable-next-line no-unsanitized/property\r\n                          styleNode.innerHTML = styleTag.innerHTML;\r\n                        });\r\n                      }\r\n                    };\r\n                  } else {\r\n                    const styleNode = styleTag.cloneNode(true);\r\n                    webComponent.shadowRoot.appendChild(styleNode);\r\n                    clonedStyleTags.push(styleNode);\r\n                  }\r\n                }\r\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};"],"names":["propTypes","notes","PropTypes","isRequired","children","onScroll","initialScrollTop","selectedIndex","sortStrategy","cache","CellMeasurerCache","defaultHeight","fixedWidth","VirtualizedList","React","_ref","forwardedRef","listRef","useRef","_useState2","_slicedToArray","useState","offset","setOffset","_useState4","width","height","dimension","setDimension","prevWindowHeight","window","innerHeight","useImperativeHandle","scrollToPosition","scrollTop","current","scrollToRow","index","useEffect","_listRef$current","_listRef$current2","clearAll","measureAllRows","_listRef$current3","_listRef$current4","forceUpdateGrid","length","windowResizeHandler","diff","addEventListener","removeEventListener","handleScroll","_ref2","rowRenderer","_ref3","key","parent","style","currNote","CellMeasurer","concat","Id","columnIndex","rowIndex","_ref4","measure","_objectSpread","paddingRight","_listRef$current5","clear","recomputeRowHeights","_resize","Measure","bounds","onResize","_ref5","_ref6","measureRef","ref","className","List","deferredMeasurementCache","outline","overscanRowCount","rowCount","rowHeight","role","displayName","NormalList","child","parentRect","getBoundingClientRect","childRect","top","clientHeight","e","target","map","annotations","onSubmit","onClose","_useSelector2","useSelector","state","selectors","getIsMentionEnabled","getActiveDocumentViewerKey","shallowEqual","isMentionEnabled","activeDocumentViewerKey","pendingReply","setPendingReply","t","useTranslation","textareaRef","focus","replyAreaClass","classNames","count","onClick","Icon","glyph","preventDefault","editor","getEditor","replyText","mentionsManager","getFormattedTextFromDeltas","getContents","trim","forEach","annotation","replyAnnotation","createMentionReply","core","addAnnotations","setAnnotationRichTextStyle","createAnnotationReply","onMouseDown","stopPropagation","NoteTextarea","el","value","onChange","handleNoteTextareaChange","isReply","Button","img","isSubmitType","triggerElementName","_ref$onClose","dispatch","useDispatch","popupRef","styleTabs","setStyleTabs","left","right","position","setPosition","colorMapKey","useOnClickOutside","clickedTrigger","document","querySelector","contains","warningModal","getOpenedWarningModal","colorPicker","getOpenedColorPicker","datePicker","getDatePicker","getAnnotationStyles","freeTextAnnotation","find","Core","Annotations","FreeTextAnnotation","getIntent","Intent","FreeText","FreeTextCallout","properties","_richTextStyles$","_richTextStyles$2","_richTextStyles$3","_richTextStyles$3$tex","_richTextStyles$4","_richTextStyles$4$tex","_richTextStyles$0$tex","_richTextStyles$5","_richTextStyles$5$tex","richTextStyles","getRichTextStyle","Font","FontSize","TextAlign","TextVerticalAlign","bold","italic","underline","includes","strikeout","availablePalettes","push","AnnotationStylePopupTabs","TEXT_COLOR","STROKE_COLOR","FILL_COLOR","updateAnnotationStylePopupTabs","newColorMap","copyMapWithDataProperties","actions","setColorMap","_styleTabs","getDataWithKey","PopupPortal","id","AnnotationStylePopup","isOpen","getOverlayPositionBasedOn","isFreeText","isRedaction","isMeasure","showLineStyleOptions","hideSnapModeCheckbox","showMultiReply","setShowMultiReply","showMultiState","setShowMultiState","showMultiStyle","setShowMultiStyle","setMultiSelectMode","isMultiSelectedMap","setIsMultiSelectedMap","multiSelectedAnnotations","getParentAnnotations","documentViewerKey","arguments","undefined","annotSet","Set","isGrouped","parentAnnotation","getAnnotationById","add","Array","from","MultiSelectControls","modifiableMultiSelectAnnotations","setModfiableMultiSelectAnnotations","isDocumentReadOnly","onAnnotationChanged","action","_isMultiSelectedMap","annot","groupedAnnots","getGroupAnnotations","some","groupedAnnot","groupAnnot","originalKeys","Object","keys","updatedKeys","filter","_modifiableMultiSelectAnnotations","multiSelectedAnnot","canModify","canGroup","getNumberOfGroups","canUngroup","NoteContext","Provider","resize","ReplyAreaMultiSelect","dataElement","DataElements","NOTE_MULTI_REPLY_BUTTON","disabled","title","NOTE_MULTI_STATE_BUTTON","active","NoteStatePopup","bottom","handleStateChange","newValue","stateAnnotation","createStateAnnotation","addReply","annotationManager","getAnnotationManager","addAnnotation","trigger","getRootAnnotation","NOTE_MULTI_STYLE_BUTTON","MultiStylePopup","NOTE_MULTI_GROUP_BUTTON","groupAnnotations","NOTE_MULTI_UNGROUP_BUTTON","ungroupAnnotations","NOTE_MULTI_DELETE_BUTTON","warning","message","confirmBtnText","onConfirm","deleteAnnotations","showWarningMessage","SORT_CONTAINER_ELEMENT","disableFilterAnnotation","setSearchInputHandler","isMultiSelectMode","toggleMultiSelectMode","isMultiSelectEnabled","getSortStrategy","isElementDisabled","getNotesPanelCustomHeaderOptions","getAnnotationFilters","getFeatureFlags","getIsOfficeEditorMode","isSortContainerDisabled","customHeaderOptions","annotationFilters","featureFlags","isOfficeEditorMode","filterEnabled","setFilterEnabled","customizableUI","authorFilter","colorFilter","statusFilter","typeFilter","toggleFilterStyle","_e$detail","detail","types","authors","colors","statuses","Events","ANNOTATION_FILTER_CHANGED","_handleInputChange","debounce","deselectAllAnnotations","sortContainer","Dropdown","items","getSortStrategies","translationPrefix","currentSelectionKey","onClickItem","strategy","setNotesPanelSortStrategy","originalHeaderElement","DataElementWrapper","NotesPanel","DefaultHeader","INPUT_CONTAINER","type","placeholder","COMMENTS_COUNTER","SORT_ROW","NOTE_MULTI_SELECT_MODE_BUTTON","FILTER_ANNOTATION_BUTTON","openElement","CustomElement","render","renderArguments","overwriteDefaultHeader","currentLeftPanelWidth","selectedNoteIds","setSelectedNoteIds","searchInput","setSearchInput","scrollToSelectedAnnot","setScrollToSelectedAnnot","isCustomPanel","isCustomPanelOpen","isLeftSide","parentDataElement","isElementOpen","NOTES_PANEL","getPageLabels","getCustomNoteFilter","getPanelWidth","getNotesPanelWidth","getNotesInLeftPanel","isAnnotationNumberingEnabled","getEnableNotesPanelVirtualizedList","isInDesktopOnlyMode","getNotesPanelCustomEmptyPanel","getIsNotesPanelMultiSelectEnabled","isDisabled","pageLabels","customNoteFilter","currentNotesPanelWidth","notesInLeftPanel","showAnnotationNumbering","enableNotesPanelVirtualizedList","customEmptyPanel","isNotesPanelMultiSelectEnabled","currentWidth","isMobile","isMobileSize","setMultiSelectedAnnotations","_useState6","_useState8","_useState10","curAnnotId","setCurAnnotId","scrollTopRef","VIRTUALIZATION_THRESHOLD","isIE","Infinity","onAnnotationNumberingUpdated","isEnabled","setAnnotationNumbering","onAnnotationSelected","singleSelectedNoteIndex","closeElement","filterNotesWithSearch","note","content","authorName","getDisplayAuthor","annotationPreview","getCustomData","toLowerCase","notesToRender","getSortedNotes","shouldRender","replies","getReplies","noteAndReplies","_toConsumableArray","setTimeout","onlyReplyContainsSearchInput","_useState12","pendingEditTextMap","setPendingEditTextMap","setPendingEditText","useCallback","pendingText","annotationID","_defineProperty","_useState14","pendingReplyMap","setPendingReplyMap","_useState16","pendingAttachmentMap","setPendingAttachmentMap","addAttachments","attachments","clearAttachments","deleteAttachment","attachment","attachmentList","indexOf","splice","values","renderChild","listSeparator","_getSortStrategies$so","shouldRenderSeparator","getSeparatorContent","prevNote","ListSeparator","renderContent","contextValue","isSelected","isContentEditable","canModifyContents","onTopNoteContentClicked","currIds","clone","deselectAnnotation","isExpandedFromSearch","Note","shouldHideConnectorLine","isMultiSelected","isInNotesPanel","handleMultiSelect","checked","groupAnnots","selectAnnotations","deselectAnnotations","NoResults","NoAnnotationsGlyph","icon","NoAnnotationsMessage","NoAnnotationsReadOnlyMessage","readOnlyMessage","shouldRenderNoAnnotationsIcon","hideIcon","shouldRenderCustomEmptyPanel","NoAnnotations","MultiSelectPlaceHolder","MultiReplyPlaceHolder","ids","findIndex","minWidth","Panel","onMouseUp","closeElements","NotesPanelHeader","Choice","isSwitch","label","getOfficeEditor","setEditMode","OFFICE_EDITOR_EDIT_MODE","PREVIEW","REVIEWING","ReplyAttachmentPicker","annotationId","props","_props$parentDataElem","isMultiViewerMode","noteMap","setNoteMap","setNotes","selectedNoteIdsMap","setSelectedNoteIdsMap","isMultiSelectedViewerMap","setIsMultiSelectedViewerMap","getGroupedAnnots","selectedAnnotations","mainAnnot","onDocumentUnloaded","_setNotes","getSelectedAnnotations","getAnnotationsList","Listable","Hidden","ToolName","Tools","ToolNames","CROP","isContentEditPlaceholder","mapAnnotationToKey","annotationMapKeys","TRACKED_CHANGE","setDocumentUnloaded1","setDocumentUnloaded2","setNotes2","setNotes1","onAnnotationSelected2","shouldDisplayMultiSelect","selectedAnnot","a","onAnnotationSelected1","passProps","_extends","exports","___CSS_LOADER_API_IMPORT___","module","locals","api","__esModule","default","options","styleTag","isApryseWebViewerWebComponent","head","appendChild","webComponents","getElementsByTagName","findNestedWebComponents","tagName","root","elements","querySelectorAll","shadowRoot","clonedStyleTags","i","webComponent","onload","styleNode","innerHTML","cloneNode"],"sourceRoot":""}