{"version":3,"file":"chunks/9197.chunk.js","mappings":"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","sources":["webpack://webviewer-ui/./src/components/InlineCommentingPopup/InlineCommentingPopup.js","webpack://webviewer-ui/./src/components/InlineCommentingPopup/InlineCommentingPopupContainer.js","webpack://webviewer-ui/./src/components/InlineCommentingPopup/index.js","webpack://webviewer-ui/./src/components/InlineCommentingPopup/InlineCommentingPopup.scss","webpack://webviewer-ui/./src/components/InlineCommentingPopup/InlineCommentingPopup.scss?b163"],"sourcesContent":["import React, { useState } from 'react';\r\nimport Draggable from 'react-draggable';\r\nimport classNames from 'classnames';\r\nimport PropTypes from 'prop-types';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport NoteContext from 'components/Note/Context';\r\nimport Note from 'components/Note';\r\nimport ReplyAttachmentPicker from 'components/NotesPanel/ReplyAttachmentPicker';\r\nimport Button from 'components/Button';\r\n\r\nimport DataElements from 'src/constants/dataElement';\r\n\r\nimport './InlineCommentingPopup.scss';\r\n\r\nconst propTypes = {\r\n  isMobile: PropTypes.bool,\r\n  isUndraggable: PropTypes.bool,\r\n  isNotesPanelClosed: PropTypes.bool,\r\n  popupRef: PropTypes.any,\r\n  position: PropTypes.object,\r\n  closeAndReset: PropTypes.func,\r\n  commentingAnnotation: PropTypes.object,\r\n  contextValue: PropTypes.object,\r\n  annotationForAttachment: PropTypes.string,\r\n  addAttachments: PropTypes.func,\r\n};\r\n\r\nconst InlineCommentingPopup = ({\r\n  isMobile,\r\n  isUndraggable,\r\n  isNotesPanelClosed,\r\n  popupRef,\r\n  position,\r\n  closeAndReset,\r\n  commentingAnnotation,\r\n  contextValue,\r\n  annotationForAttachment,\r\n  addAttachments,\r\n}) => {\r\n  const [t] = useTranslation();\r\n  const [isExpanded, setExpanded] = useState(false);\r\n\r\n  const inlineCommentPopup = (\r\n    <div\r\n      className={classNames({\r\n        Popup: true,\r\n        InlineCommentingPopup: true,\r\n        open: isNotesPanelClosed,\r\n      })}\r\n      ref={popupRef}\r\n      data-element={DataElements.INLINE_COMMENT_POPUP}\r\n      style={{ ...position }}\r\n      onMouseDown={(e) => {\r\n        if (isMobile) {\r\n          e.stopPropagation();\r\n          closeAndReset();\r\n        }\r\n      }}\r\n      onKeyDown={(e) => {\r\n        if (e.key === 'Escape') {\r\n          closeAndReset();\r\n        }\r\n      }}\r\n    >\r\n      <div\r\n        className={classNames({\r\n          'inline-comment-container': true,\r\n          'expanded': isExpanded,\r\n        })}\r\n        onMouseDown={(e) => {\r\n          if (isMobile) {\r\n            e.stopPropagation();\r\n          }\r\n        }}\r\n      >\r\n        {isMobile && (\r\n          <div className='inline-comment-header'>\r\n            <Button\r\n              img={isExpanded ? 'icon-chevron-down' : 'icon-chevron-up'}\r\n              className=\"expand-arrow\"\r\n              dataElement={DataElements.INLINE_COMMENT_POPUP_EXPAND_BUTTON}\r\n              onClick={() => setExpanded(!isExpanded)}\r\n            />\r\n            <span className='inline-comment-header-title'>{t('action.comment')}</span>\r\n            <Button\r\n              img={'icon-close'}\r\n              dataElement={DataElements.INLINE_COMMENT_POPUP_CLOSE_BUTTON}\r\n              onClick={closeAndReset}\r\n            />\r\n          </div>\r\n        )}\r\n        <NoteContext.Provider value={contextValue}>\r\n          <Note\r\n            annotation={commentingAnnotation}\r\n            isMultiSelected={false}\r\n            isMultiSelectMode={false}\r\n            handleMultiSelect={() => { }}\r\n          />\r\n          <ReplyAttachmentPicker\r\n            annotationId={annotationForAttachment}\r\n            addAttachments={addAttachments}\r\n          />\r\n        </NoteContext.Provider>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return isUndraggable ? (\r\n    inlineCommentPopup\r\n  ) : (\r\n    <Draggable cancel=\".Button, .cell, svg, select, button, input, .quill, .note-text-preview\">{inlineCommentPopup}</Draggable>\r\n  );\r\n};\r\n\r\nInlineCommentingPopup.propTypes = propTypes;\r\n\r\nexport default InlineCommentingPopup;\r\n","import React, { useState, useRef, useCallback, useLayoutEffect } from 'react';\r\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\r\nimport InlineCommentingPopup from './InlineCommentingPopup';\r\nimport core from 'core';\r\nimport { getAnnotationPopupPositionBasedOn as getPopupPosition } from 'helpers/getPopupPosition';\r\nimport { getOpenedWarningModal, getOpenedColorPicker, getDatePicker } from 'helpers/getElements';\r\nimport useOnClickOutside from 'hooks/useOnClickOutside';\r\nimport actions from 'actions';\r\nimport selectors from 'selectors';\r\nimport { isMobile as isPhone, isIE, isMobileDevice } from 'helpers/device';\r\nimport DataElements from 'constants/dataElement';\r\nimport getRootNode from 'helpers/getRootNode';\r\n\r\nconst InlineCommentingPopupContainer = ({ annotation, closeAndReset }) => {\r\n  const [\r\n    isNotesPanelOpen,\r\n    notesInLeftPanel,\r\n    isLeftPanelOpen,\r\n    activeLeftPanel,\r\n    showAnnotationNumbering,\r\n    sortStrategy,\r\n    isDocumentReadOnly,\r\n    activeDocumentViewerKey,\r\n  ] = useSelector(\r\n    (state) => [\r\n      selectors.isElementOpen(state, DataElements.NOTES_PANEL),\r\n      selectors.getNotesInLeftPanel(state),\r\n      selectors.isElementOpen(state, DataElements.LEFT_PANEL),\r\n      selectors.getActiveLeftPanel(state),\r\n      selectors.isAnnotationNumberingEnabled(state),\r\n      selectors.getSortStrategy(state),\r\n      selectors.isDocumentReadOnly(state),\r\n      selectors.getActiveDocumentViewerKey(state),\r\n    ],\r\n    shallowEqual,\r\n  );\r\n  const dispatch = useDispatch();\r\n  const [position, setPosition] = useState({ left: 0, top: 0 });\r\n  const popupRef = useRef();\r\n  // on tablet, the behaviour will be like on desktop, except being draggable\r\n  const isMobile = isPhone();\r\n  const isUndraggable = isMobile || !!isMobileDevice || isIE;\r\n  const isNotesPanelOpenOrActive = isNotesPanelOpen || (notesInLeftPanel && isLeftPanelOpen && activeLeftPanel === 'notesPanel');\r\n\r\n  useOnClickOutside(popupRef, (e) => {\r\n    const notesPanel = getRootNode().querySelector('[data-element=\"notesPanel\"]');\r\n    const clickedInNotesPanel = notesPanel?.contains(e.target);\r\n    const notePopupState = getRootNode().querySelector('[data-element=\"notePopupState\"]');\r\n    const clickedInNotePopupState = notePopupState?.contains(e.target);\r\n    const datePicker = getDatePicker();\r\n    const warningModal = getOpenedWarningModal();\r\n    const colorPicker = getOpenedColorPicker();\r\n\r\n    // the notes panel has mousedown handlers to handle the opening/closing states of this component\r\n    // we don't want this handler to run when clicked in the notes panel otherwise the opening/closing states may mess up\r\n    // for example: click on a note will call core.selectAnnotation which triggers the annotationSelected event\r\n    // and opens this component. If we don't exclude the notes panel this handler will run and close it after\r\n    if (!clickedInNotesPanel && !clickedInNotePopupState && !warningModal && !colorPicker && !datePicker) {\r\n      dispatch(actions.closeElement(DataElements.INLINE_COMMENT_POPUP));\r\n    }\r\n  });\r\n\r\n  const isNotesPanelClosed = !isNotesPanelOpenOrActive;\r\n\r\n  useLayoutEffect(() => {\r\n    if (isNotesPanelClosed && popupRef.current && !isMobile) {\r\n      setPosition(getPopupPosition(annotation, popupRef, activeDocumentViewerKey));\r\n    }\r\n  }, [activeDocumentViewerKey]);\r\n\r\n  // TO-DO refactor: Lines 189-239 was copied from NotesPanel 228-275\r\n  const [pendingAttachmentMap, setPendingAttachmentMap] = useState({});\r\n  const addAttachments = (annotationID, attachments) => {\r\n    setPendingAttachmentMap((map) => ({\r\n      ...map,\r\n      [annotationID]: [...(map[annotationID] || []), ...attachments]\r\n    }));\r\n  };\r\n\r\n  const [annotationForAttachment, setAnnotationForAttachment] = useState(undefined);\r\n\r\n  const [pendingEditTextMap, setPendingEditTextMap] = useState({});\r\n  const setPendingEditText = useCallback(\r\n    (pendingText, annotationID) => {\r\n      setPendingEditTextMap((map) => ({\r\n        ...map,\r\n        [annotationID]: pendingText,\r\n      }));\r\n    },\r\n    [setPendingEditTextMap],\r\n  );\r\n\r\n  const [pendingReplyMap, setPendingReplyMap] = useState({});\r\n  const setPendingReply = useCallback(\r\n    (pendingReply, annotationID) => {\r\n      setPendingReplyMap((map) => ({\r\n        ...map,\r\n        [annotationID]: pendingReply,\r\n      }));\r\n    },\r\n    [setPendingReplyMap],\r\n  );\r\n  const clearAttachments = (annotationID) => {\r\n    setPendingAttachmentMap((map) => ({\r\n      ...map,\r\n      [annotationID]: []\r\n    }));\r\n  };\r\n  const deleteAttachment = (annotationID, attachment) => {\r\n    const attachmentList = pendingAttachmentMap[annotationID];\r\n    if (attachmentList?.length > 0) {\r\n      const index = attachmentList.indexOf(attachment);\r\n      if (index > -1) {\r\n        attachmentList.splice(index, 1);\r\n        setPendingAttachmentMap((map) => ({\r\n          ...map,\r\n          [annotationID]: [...attachmentList]\r\n        }));\r\n      }\r\n    }\r\n  };\r\n\r\n  const contextValue = {\r\n    searchInput: '',\r\n    resize: () => { },\r\n    isSelected: true,\r\n    isContentEditable: core.canModifyContents(annotation) && !annotation.getContents(),\r\n    pendingEditTextMap,\r\n    setPendingEditText,\r\n    pendingReplyMap,\r\n    setPendingReply,\r\n    isDocumentReadOnly,\r\n    onTopNoteContentClicked: () => { },\r\n    isExpandedFromSearch: false,\r\n    scrollToSelectedAnnot: false,\r\n    sortStrategy,\r\n    showAnnotationNumbering,\r\n    setCurAnnotId: setAnnotationForAttachment,\r\n    pendingAttachmentMap,\r\n    addAttachments,\r\n    clearAttachments,\r\n    deleteAttachment,\r\n  };\r\n\r\n  return (\r\n    <InlineCommentingPopup\r\n      isMobile={isMobile}\r\n      isUndraggable={isUndraggable}\r\n      isNotesPanelClosed={isNotesPanelClosed}\r\n      popupRef={popupRef}\r\n      position={position}\r\n      closeAndReset={closeAndReset}\r\n      commentingAnnotation={annotation}\r\n      contextValue={contextValue}\r\n      annotationForAttachment={annotationForAttachment}\r\n      addAttachments={addAttachments}\r\n    />\r\n  );\r\n};\r\n\r\nexport default InlineCommentingPopupContainer;\r\n","import InlineCommentingPopupContainer from './InlineCommentingPopupContainer';\r\n\r\nexport default InlineCommentingPopupContainer;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".open.InlineCommentingPopup{visibility:visible}.closed.InlineCommentingPopup{visibility:hidden}:host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.InlineCommentingPopup{position:absolute;z-index:70;display:flex;justify-content:center;align-items:center}.InlineCommentingPopup:empty{padding:0}.InlineCommentingPopup .buttons{display:flex}.InlineCommentingPopup .Button{margin:4px;width:32px;height:32px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Button{width:42px;height:42px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Button{width:42px;height:42px}}.InlineCommentingPopup .Button:hover{background:var(--popup-button-hover)}.InlineCommentingPopup .Button .Icon{width:18px;height:18px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Button .Icon{width:24px;height:24px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Button .Icon{width:24px;height:24px}}.is-vertical.InlineCommentingPopup .Button.main-menu-button{width:100%;border-radius:0;justify-content:flex-start;padding-left:var(--padding-small);padding-right:var(--padding-small);margin:0 0 var(--padding-tiny) 0}.is-vertical.InlineCommentingPopup .Button.main-menu-button:first-child{margin-top:var(--padding-tiny)}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .is-vertical.InlineCommentingPopup .Button.main-menu-button{width:100%;height:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .is-vertical.InlineCommentingPopup .Button.main-menu-button{width:100%;height:32px}}.is-vertical.InlineCommentingPopup .Button.main-menu-button .Icon{margin-right:10px}.is-vertical.InlineCommentingPopup .Button.main-menu-button span{white-space:nowrap}@keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}.InlineCommentingPopup{border-radius:4px;box-shadow:0 0 3px 0 var(--document-box-shadow);background:var(--component-background);align-items:flex-start}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup{position:fixed;left:0;bottom:0;z-index:100;flex-direction:column;justify-content:flex-end;width:100%;background:var(--modal-negative-space)}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup{position:fixed;left:0;bottom:0;z-index:100;flex-direction:column;justify-content:flex-end;width:100%;background:var(--modal-negative-space)}}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup{overflow:auto;max-height:calc(100% - 100px)}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup{overflow:auto;max-height:calc(100% - 100px)}}.InlineCommentingPopup .inline-comment-container{display:flex;flex-direction:column}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .inline-comment-container{flex-basis:auto;width:100%;max-height:40%;background:var(--component-background);box-shadow:0 0 3px 0 var(--document-box-shadow);border-radius:4px 4px 0 0}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .inline-comment-container{flex-basis:auto;width:100%;max-height:40%;background:var(--component-background);box-shadow:0 0 3px 0 var(--document-box-shadow);border-radius:4px 4px 0 0}}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .inline-comment-container{max-width:260px}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .inline-comment-container{max-width:260px}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .inline-comment-container.expanded{flex-grow:1;max-height:90%}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .inline-comment-container.expanded{flex-grow:1;max-height:90%}}.InlineCommentingPopup .Note{border-radius:0;background:none;margin:0;cursor:default}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Note{flex-grow:1;display:flex;flex-direction:column;overflow:auto;box-shadow:0 0 3px 0 var(--document-box-shadow)}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Note{flex-grow:1;display:flex;flex-direction:column;overflow:auto;box-shadow:0 0 3px 0 var(--document-box-shadow)}}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Note{box-shadow:none}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Note{box-shadow:none}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Note>div:not(:nth-last-child(2)){flex-grow:0}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Note>div:not(:nth-last-child(2)){flex-grow:0}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Note>div:nth-last-child(2){flex-grow:1}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Note>div:nth-last-child(2){flex-grow:1}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Note>.NoteContent:only-child{flex-grow:1}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Note>.NoteContent:only-child{flex-grow:1}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Note>.NoteContent:only-child .edit-content{flex-grow:0}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Note>.NoteContent:only-child .edit-content{flex-grow:0}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .NoteHeader{flex-grow:0}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .NoteHeader{flex-grow:0}}.InlineCommentingPopup .NoteContent .edit-content{margin-top:16px}.InlineCommentingPopup .note-popup-options:not(.options-reply){top:33px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .ql-container,.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .ql-editor,.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .quill{font-size:16px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .ql-container,.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .ql-editor,.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .quill{font-size:16px}}.InlineCommentingPopup .inline-comment-header{flex-grow:0;flex-shrink:0;display:flex;flex-direction:row;align-items:center}.InlineCommentingPopup .inline-comment-header-title{flex-grow:1;font-size:16px}.InlineCommentingPopup .Button.add-attachment,.InlineCommentingPopup .Button.reply-button{margin:0}.InlineCommentingPopup .Button.add-attachment .Icon,.InlineCommentingPopup .Button.reply-button .Icon{width:22px;height:22px}.InlineCommentingPopup .Button.add-attachment{width:24px;height:24px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Button.add-attachment{width:24px;height:24px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Button.add-attachment{width:24px;height:24px}}.InlineCommentingPopup .Button.reply-button{width:28px;height:28px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .InlineCommentingPopup .Button.reply-button{width:28px;height:28px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .InlineCommentingPopup .Button.reply-button{width:28px;height:28px}}.sb-show-main .InlineCommentingPopup .quill.comment-textarea{padding:0}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};\nmodule.exports = exports;\n","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ruleSet[1].rules[1].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./InlineCommentingPopup.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\r\n                function findNestedWebComponents(tagName, root = document) {\r\n                  const elements = [];\r\n\r\n                  // Check direct children\r\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\r\n\r\n                  // Check shadow DOMs\r\n                  root.querySelectorAll('*').forEach(el => {\r\n                    if (el.shadowRoot) {\r\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\r\n                    }\r\n                  });\r\n\r\n                  return elements;\r\n                }\r\n                if (!window.isApryseWebViewerWebComponent) {\r\n                  document.head.appendChild(styleTag);\r\n                  return;\r\n                }\r\n\r\n                let webComponents;\r\n                // First we see if the webcomponent is at the document level\r\n                webComponents = document.getElementsByTagName('apryse-webviewer');\r\n                // If not, we check have to check if it is nested in another webcomponent\r\n                if (!webComponents.length) {\r\n                  webComponents = findNestedWebComponents('apryse-webviewer');\r\n                }\r\n                // Now we append the style tag to each webcomponent\r\n                const clonedStyleTags = [];\r\n                for (let i = 0; i < webComponents.length; i++) {\r\n                  const webComponent = webComponents[i];\r\n                  if (i === 0) {\r\n                    webComponent.shadowRoot.appendChild(styleTag);\r\n                    styleTag.onload = function () {\r\n                      if (clonedStyleTags.length > 0) {\r\n                        clonedStyleTags.forEach((styleNode) => {\r\n                          // eslint-disable-next-line no-unsanitized/property\r\n                          styleNode.innerHTML = styleTag.innerHTML;\r\n                        });\r\n                      }\r\n                    };\r\n                  } else {\r\n                    const styleNode = styleTag.cloneNode(true);\r\n                    webComponent.shadowRoot.appendChild(styleNode);\r\n                    clonedStyleTags.push(styleNode);\r\n                  }\r\n                }\r\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};"],"names":["propTypes","isMobile","PropTypes","isUndraggable","isNotesPanelClosed","popupRef","position","closeAndReset","commentingAnnotation","contextValue","annotationForAttachment","addAttachments","InlineCommentingPopup","_ref","t","_slicedToArray","useTranslation","_useState2","useState","isExpanded","setExpanded","inlineCommentPopup","React","className","classNames","Popup","open","ref","DataElements","INLINE_COMMENT_POPUP","style","_objectSpread","onMouseDown","e","stopPropagation","onKeyDown","key","Button","img","dataElement","INLINE_COMMENT_POPUP_EXPAND_BUTTON","onClick","INLINE_COMMENT_POPUP_CLOSE_BUTTON","NoteContext","Provider","value","Note","annotation","isMultiSelected","isMultiSelectMode","handleMultiSelect","ReplyAttachmentPicker","annotationId","Draggable","cancel","_useSelector2","useSelector","state","selectors","isElementOpen","NOTES_PANEL","getNotesInLeftPanel","LEFT_PANEL","getActiveLeftPanel","isAnnotationNumberingEnabled","getSortStrategy","isDocumentReadOnly","getActiveDocumentViewerKey","shallowEqual","isNotesPanelOpen","notesInLeftPanel","isLeftPanelOpen","activeLeftPanel","showAnnotationNumbering","sortStrategy","activeDocumentViewerKey","dispatch","useDispatch","left","top","setPosition","useRef","isPhone","isMobileDevice","isIE","isNotesPanelOpenOrActive","useOnClickOutside","notesPanel","getRootNode","querySelector","clickedInNotesPanel","contains","target","notePopupState","clickedInNotePopupState","datePicker","getDatePicker","warningModal","getOpenedWarningModal","colorPicker","getOpenedColorPicker","actions","closeElement","useLayoutEffect","current","getPopupPosition","_useState4","pendingAttachmentMap","setPendingAttachmentMap","annotationID","attachments","map","_defineProperty","concat","_toConsumableArray","_useState6","undefined","setAnnotationForAttachment","_useState8","pendingEditTextMap","setPendingEditTextMap","setPendingEditText","useCallback","pendingText","_useState10","pendingReplyMap","setPendingReplyMap","setPendingReply","pendingReply","searchInput","resize","isSelected","isContentEditable","core","canModifyContents","getContents","onTopNoteContentClicked","isExpandedFromSearch","scrollToSelectedAnnot","setCurAnnotId","clearAttachments","deleteAttachment","attachment","attachmentList","length","index","indexOf","splice","exports","___CSS_LOADER_API_IMPORT___","push","module","id","locals","api","content","__esModule","default","options","styleTag","window","isApryseWebViewerWebComponent","document","head","appendChild","webComponents","getElementsByTagName","findNestedWebComponents","tagName","root","elements","querySelectorAll","forEach","el","shadowRoot","clonedStyleTags","i","webComponent","onload","styleNode","innerHTML","cloneNode"],"sourceRoot":""}